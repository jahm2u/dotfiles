"use strict";var io=Object.create;var bt=Object.defineProperty;var oo=Object.getOwnPropertyDescriptor;var ao=Object.getOwnPropertyNames;var co=Object.getPrototypeOf,ho=Object.prototype.hasOwnProperty;var I=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),uo=(t,e)=>{for(var r in e)bt(t,r,{get:e[r],enumerable:!0})},fn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ao(e))!ho.call(t,s)&&s!==r&&bt(t,s,{get:()=>e[s],enumerable:!(n=oo(e,s))||n.enumerable});return t};var D=(t,e,r)=>(r=t!=null?io(co(t)):{},fn(e||!t||!t.__esModule?bt(r,"default",{value:t,enumerable:!0}):r,t)),lo=t=>fn(bt({},"__esModule",{value:!0}),t);var Cn=I(Xt=>{"use strict";Xt.toString=function(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t};Xt.toType=function(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}});var On=I(Zt=>{"use strict";Zt.toString=function(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t};Zt.toRcode=function(t){switch(t.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}});var Rn=I(er=>{"use strict";er.toString=function(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t};er.toOpcode=function(t){switch(t.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}});var In=I(tr=>{"use strict";tr.toString=function(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t};tr.toClass=function(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}});var Tn=I(rr=>{"use strict";rr.toString=function(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:`OPTION_${t}`};rr.toCode=function(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}let e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}});var kn=I((An,nr)=>{var Pn=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=x,t.encode=b,t.familyOf=m,t.name=void 0,t.sizeOf=h,t.v6=t.v4=void 0;let e=/^(\d{1,3}\.){3,3}\d{1,3}$/,r=4,n=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,s=16,i={name:"v4",size:r,isFormat:y=>e.test(y),encode(y,p,l){l=~~l,p=p||new Uint8Array(l+r);let u=y.length,S=0;for(let _=0;_<u;){let R=y.charCodeAt(_++);R===46?(p[l++]=S,S=0):S=S*10+(R-48)}return p[l]=S,p},decode(y,p){return p=~~p,`${y[p++]}.${y[p++]}.${y[p++]}.${y[p]}`}};t.v4=i;let o={name:"v6",size:s,isFormat:y=>y.length>0&&n.test(y),encode(y,p,l){l=~~l;let u=l+s,S=-1,_=0,R=0,E=!0,P=!1;p=p||new Uint8Array(l+s);for(let U=0;U<y.length;U++){let N=y.charCodeAt(U);N===58?(E?S!==-1?(l<u&&(p[l]=0),l<u-1&&(p[l+1]=0),l+=2):l<u&&(S=l):(P===!0?(l<u&&(p[l]=R),l++):(l<u&&(p[l]=_>>8),l<u-1&&(p[l+1]=_&255),l+=2),_=0,R=0),E=!0,P=!1):N===46?(l<u&&(p[l]=R),l++,R=0,_=0,E=!1,P=!0):(E=!1,N>=97?N-=87:N>=65?N-=55:(N-=48,R=R*10+N),_=(_<<4)+N)}if(E===!1)P===!0?(l<u&&(p[l]=R),l++):(l<u&&(p[l]=_>>8),l<u-1&&(p[l+1]=_&255),l+=2);else if(S===0)l<u&&(p[l]=0),l<u-1&&(p[l+1]=0),l+=2;else if(S!==-1){l+=2;for(let U=Math.min(l-1,u-1);U>=S+2;U--)p[U]=p[U-2];p[S]=0,p[S+1]=0,S=l}if(S!==l&&S!==-1)for(l>u-2&&(l=u-2);u>S;)p[--u]=l<u&&l>S?p[--l]:0;else for(;l<u;)p[l++]=0;return p},decode(y,p){p=~~p;let l="";for(let u=0;u<s;u+=2)u!==0&&(l+=":"),l+=(y[p+u]<<8|y[p+u+1]).toString(16);return l.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};t.v6=o;let a="ip";t.name=a;function h(y){if(i.isFormat(y))return i.size;if(o.isFormat(y))return o.size;throw Error(`Invalid ip address: ${y}`)}function m(y){return h(y)===i.size?1:2}function b(y,p,l){l=~~l;let u=h(y);return typeof p=="function"&&(p=p(l+u)),u===i.size?i.encode(y,p,l):o.encode(y,p,l)}function x(y,p,l){if(p=~~p,l=l||y.length-p,l===i.size)return i.decode(y,p,l);if(l===o.size)return o.decode(y,p,l);throw Error(`Invalid buffer size needs to be ${i.size} for v4 or ${o.size} for v6.`)}return"default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return Pn}):typeof nr=="object"&&typeof An=="object"&&(nr.exports=Pn)});var Nn=I(C=>{"use strict";var O=require("buffer").Buffer,be=Cn(),yo=On(),go=Rn(),St=In(),sr=Tn(),Ae=kn(),fo=0,Un=32768,ir=32768,_o=~ir,Ln=32768,wo=~Ln,w=C.name={};w.encode=function(t,e,r,{mail:n=!1}={}){e||(e=O.alloc(w.encodingLength(t))),r||(r=0);let s=r,i=t.replace(/^\.|\.$/gm,"");if(i.length){let o=[];if(n){let a="";i.split(".").forEach(h=>{h.endsWith("\\")?a+=(a.length?".":"")+h.slice(0,-1):o.length===0&&a.length?o.push(a+"."+h):o.push(h)})}else o=i.split(".");for(let a=0;a<o.length;a++){let h=e.write(o[a],r+1);e[r]=h,r+=h+1}}return e[r++]=0,w.encode.bytes=r-s,e};w.encode.bytes=0;w.decode=function(t,e,{mail:r=!1}={}){e||(e=0);let n=[],s=e,i=0,o=0,a=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");let h=t[e++];if(o+=a?0:1,h===0)break;if((h&192)===0){if(e+h>t.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=h+1,i>254)throw new Error("Cannot decode name (name too long)");let m=t.toString("utf-8",e,e+h);r&&(m=m.replace(/\./g,"\\.")),n.push(m),e+=h,o+=a?0:h}else if((h&192)===192){if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");let m=t.readUInt16BE(e-1)-49152;if(m>=s)throw new Error("Cannot decode name (bad pointer)");e=m,s=m,o+=a?0:1,a=!0}else throw new Error("Cannot decode name (bad label)")}return w.decode.bytes=o,n.length===0?".":n.join(".")};w.decode.bytes=0;w.encodingLength=function(t){return t==="."||t===".."?1:O.byteLength(t.replace(/^\.|\.$/gm,""))+2};var T={};T.encode=function(t,e,r){e||(e=O.alloc(T.encodingLength(t))),r||(r=0);let n=e.write(t,r+1);return e[r]=n,T.encode.bytes=n+1,e};T.encode.bytes=0;T.decode=function(t,e){e||(e=0);let r=t[e],n=t.toString("utf-8",e+1,e+1+r);return T.decode.bytes=r+1,n};T.decode.bytes=0;T.encodingLength=function(t){return O.byteLength(t)+1};var ee={};ee.encode=function(t,e,r){e||(e=ee.encodingLength(t)),r||(r=0);let n=(t.flags||0)&32767,s=t.type==="response"?Un:fo;return e.writeUInt16BE(t.id||0,r),e.writeUInt16BE(n|s,r+2),e.writeUInt16BE(t.questions.length,r+4),e.writeUInt16BE(t.answers.length,r+6),e.writeUInt16BE(t.authorities.length,r+8),e.writeUInt16BE(t.additionals.length,r+10),e};ee.encode.bytes=12;ee.decode=function(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");let r=t.readUInt16BE(e+2);return{id:t.readUInt16BE(e),type:r&Un?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:go.toString(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:yo.toString(r&15),questions:new Array(t.readUInt16BE(e+4)),answers:new Array(t.readUInt16BE(e+6)),authorities:new Array(t.readUInt16BE(e+8)),additionals:new Array(t.readUInt16BE(e+10))}};ee.decode.bytes=12;ee.encodingLength=function(){return 12};var ue=C.unknown={};ue.encode=function(t,e,r){return e||(e=O.alloc(ue.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.length,r),t.copy(e,r+2),ue.encode.bytes=t.length+2,e};ue.encode.bytes=0;ue.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n=t.slice(e+2,e+2+r);return ue.decode.bytes=r+2,n};ue.decode.bytes=0;ue.encodingLength=function(t){return t.length+2};var le=C.ns={};le.encode=function(t,e,r){return e||(e=O.alloc(le.encodingLength(t))),r||(r=0),w.encode(t,e,r+2),e.writeUInt16BE(w.encode.bytes,r),le.encode.bytes=w.encode.bytes+2,e};le.encode.bytes=0;le.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n=w.decode(t,e+2);return le.decode.bytes=r+2,n};le.decode.bytes=0;le.encodingLength=function(t){return w.encodingLength(t)+2};var me=C.soa={};me.encode=function(t,e,r){e||(e=O.alloc(me.encodingLength(t))),r||(r=0);let n=r;return r+=2,w.encode(t.mname,e,r),r+=w.encode.bytes,w.encode(t.rname,e,r,{mail:!0}),r+=w.encode.bytes,e.writeUInt32BE(t.serial||0,r),r+=4,e.writeUInt32BE(t.refresh||0,r),r+=4,e.writeUInt32BE(t.retry||0,r),r+=4,e.writeUInt32BE(t.expire||0,r),r+=4,e.writeUInt32BE(t.minimum||0,r),r+=4,e.writeUInt16BE(r-n-2,n),me.encode.bytes=r-n,e};me.encode.bytes=0;me.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.mname=w.decode(t,e),e+=w.decode.bytes,n.rname=w.decode(t,e,{mail:!0}),e+=w.decode.bytes,n.serial=t.readUInt32BE(e),e+=4,n.refresh=t.readUInt32BE(e),e+=4,n.retry=t.readUInt32BE(e),e+=4,n.expire=t.readUInt32BE(e),e+=4,n.minimum=t.readUInt32BE(e),e+=4,me.decode.bytes=e-r,n};me.decode.bytes=0;me.encodingLength=function(t){return 22+w.encodingLength(t.mname)+w.encodingLength(t.rname)};var pe=C.txt={};pe.encode=function(t,e,r){Array.isArray(t)||(t=[t]);for(let s=0;s<t.length;s++)if(typeof t[s]=="string"&&(t[s]=O.from(t[s])),!O.isBuffer(t[s]))throw new Error("Must be a Buffer");e||(e=O.alloc(pe.encodingLength(t))),r||(r=0);let n=r;return r+=2,t.forEach(function(s){e[r++]=s.length,s.copy(e,r,0,s.length),r+=s.length}),e.writeUInt16BE(r-n-2,n),pe.encode.bytes=r-n,e};pe.encode.bytes=0;pe.decode=function(t,e){e||(e=0);let r=e,n=t.readUInt16BE(e);e+=2;let s=[];for(;n>0;){let i=t[e++];if(--n,n<i)throw new Error("Buffer overflow");s.push(t.slice(e,e+i)),e+=i,n-=i}return pe.decode.bytes=e-r,s};pe.decode.bytes=0;pe.encodingLength=function(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){typeof r=="string"?e+=O.byteLength(r)+1:e+=r.length+1}),e};var ye=C.null={};ye.encode=function(t,e,r){e||(e=O.alloc(ye.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=O.from(t)),t||(t=O.alloc(0));let n=r;r+=2;let s=t.length;return t.copy(e,r,0,s),r+=s,e.writeUInt16BE(r-n-2,n),ye.encode.bytes=r-n,e};ye.encode.bytes=0;ye.decode=function(t,e){e||(e=0);let r=e,n=t.readUInt16BE(e);e+=2;let s=t.slice(e,e+n);return e+=n,ye.decode.bytes=e-r,s};ye.decode.bytes=0;ye.encodingLength=function(t){return t?(O.isBuffer(t)?t.length:O.byteLength(t))+2:2};var ge=C.hinfo={};ge.encode=function(t,e,r){e||(e=O.alloc(ge.encodingLength(t))),r||(r=0);let n=r;return r+=2,T.encode(t.cpu,e,r),r+=T.encode.bytes,T.encode(t.os,e,r),r+=T.encode.bytes,e.writeUInt16BE(r-n-2,n),ge.encode.bytes=r-n,e};ge.encode.bytes=0;ge.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.cpu=T.decode(t,e),e+=T.decode.bytes,n.os=T.decode(t,e),e+=T.decode.bytes,ge.decode.bytes=e-r,n};ge.decode.bytes=0;ge.encodingLength=function(t){return T.encodingLength(t.cpu)+T.encodingLength(t.os)+2};var X=C.ptr={},bo=C.cname=X,Eo=C.dname=X;X.encode=function(t,e,r){return e||(e=O.alloc(X.encodingLength(t))),r||(r=0),w.encode(t,e,r+2),e.writeUInt16BE(w.encode.bytes,r),X.encode.bytes=w.encode.bytes+2,e};X.encode.bytes=0;X.decode=function(t,e){e||(e=0);let r=w.decode(t,e+2);return X.decode.bytes=w.decode.bytes+2,r};X.decode.bytes=0;X.encodingLength=function(t){return w.encodingLength(t)+2};var fe=C.srv={};fe.encode=function(t,e,r){e||(e=O.alloc(fe.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.priority||0,r+2),e.writeUInt16BE(t.weight||0,r+4),e.writeUInt16BE(t.port||0,r+6),w.encode(t.target,e,r+8);let n=w.encode.bytes+6;return e.writeUInt16BE(n,r),fe.encode.bytes=n+2,e};fe.encode.bytes=0;fe.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n={};return n.priority=t.readUInt16BE(e+2),n.weight=t.readUInt16BE(e+4),n.port=t.readUInt16BE(e+6),n.target=w.decode(t,e+8),fe.decode.bytes=r+2,n};fe.decode.bytes=0;fe.encodingLength=function(t){return 8+w.encodingLength(t.target)};var W=C.caa={};W.ISSUER_CRITICAL=128;W.encode=function(t,e,r){let n=W.encodingLength(t);return e||(e=O.alloc(W.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=W.ISSUER_CRITICAL),e.writeUInt16BE(n-2,r),r+=2,e.writeUInt8(t.flags||0,r),r+=1,T.encode(t.tag,e,r),r+=T.encode.bytes,e.write(t.value,r),r+=O.byteLength(t.value),W.encode.bytes=n,e};W.encode.bytes=0;W.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e);e+=2;let n=e,s={};return s.flags=t.readUInt8(e),e+=1,s.tag=T.decode(t,e),e+=T.decode.bytes,s.value=t.toString("utf-8",e,n+r),s.issuerCritical=!!(s.flags&W.ISSUER_CRITICAL),W.decode.bytes=r+2,s};W.decode.bytes=0;W.encodingLength=function(t){return T.encodingLength(t.tag)+T.encodingLength(t.value)+2};var Ce=C.mx={};Ce.encode=function(t,e,r){e||(e=O.alloc(Ce.encodingLength(t))),r||(r=0);let n=r;return r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,w.encode(t.exchange,e,r),r+=w.encode.bytes,e.writeUInt16BE(r-n-2,n),Ce.encode.bytes=r-n,e};Ce.encode.bytes=0;Ce.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.preference=t.readUInt16BE(e),e+=2,n.exchange=w.decode(t,e),e+=w.decode.bytes,Ce.decode.bytes=e-r,n};Ce.encodingLength=function(t){return 4+w.encodingLength(t.exchange)};var _e=C.a={};_e.encode=function(t,e,r){return e||(e=O.alloc(_e.encodingLength(t))),r||(r=0),e.writeUInt16BE(4,r),r+=2,Ae.v4.encode(t,e,r),_e.encode.bytes=6,e};_e.encode.bytes=0;_e.decode=function(t,e){e||(e=0),e+=2;let r=Ae.v4.decode(t,e);return _e.decode.bytes=6,r};_e.decode.bytes=0;_e.encodingLength=function(){return 6};var we=C.aaaa={};we.encode=function(t,e,r){return e||(e=O.alloc(we.encodingLength(t))),r||(r=0),e.writeUInt16BE(16,r),r+=2,Ae.v6.encode(t,e,r),we.encode.bytes=18,e};we.encode.bytes=0;we.decode=function(t,e){e||(e=0),e+=2;let r=Ae.v6.decode(t,e);return we.decode.bytes=18,r};we.decode.bytes=0;we.encodingLength=function(){return 18};var G=C.option={};G.encode=function(t,e,r){e||(e=O.alloc(G.encodingLength(t))),r||(r=0);let n=r,s=sr.toCode(t.code);if(e.writeUInt16BE(s,r),r+=2,t.data)e.writeUInt16BE(t.data.length,r),r+=2,t.data.copy(e,r),r+=t.data.length;else switch(s){case 8:let i=t.sourcePrefixLength||0,o=t.family||Ae.familyOf(t.ip),a=Ae.encode(t.ip,O.alloc),h=Math.ceil(i/8);e.writeUInt16BE(h+4,r),r+=2,e.writeUInt16BE(o,r),r+=2,e.writeUInt8(i,r++),e.writeUInt8(t.scopePrefixLength||0,r++),a.copy(e,r,0,h),r+=h;break;case 11:t.timeout?(e.writeUInt16BE(2,r),r+=2,e.writeUInt16BE(t.timeout,r),r+=2):(e.writeUInt16BE(0,r),r+=2);break;case 12:let m=t.length||0;e.writeUInt16BE(m,r),r+=2,e.fill(0,r,r+m),r+=m;break;case 14:let b=t.tags.length*2;e.writeUInt16BE(b,r),r+=2;for(let x of t.tags)e.writeUInt16BE(x,r),r+=2;break;default:throw new Error(`Unknown roption code: ${t.code}`)}return G.encode.bytes=r-n,e};G.encode.bytes=0;G.decode=function(t,e){e||(e=0);let r={};r.code=t.readUInt16BE(e),r.type=sr.toString(r.code),e+=2;let n=t.readUInt16BE(e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=t.readUInt16BE(e),e+=2,r.sourcePrefixLength=t.readUInt8(e++),r.scopePrefixLength=t.readUInt8(e++);let s=O.alloc(r.family===1?4:16);t.copy(s,0,e,e+n-4),r.ip=Ae.decode(s);break;case 11:n>0&&(r.timeout=t.readUInt16BE(e),e+=2);break;case 14:r.tags=[];for(let i=0;i<n;i+=2)r.tags.push(t.readUInt16BE(e)),e+=2}return G.decode.bytes=n+4,r};G.decode.bytes=0;G.encodingLength=function(t){if(t.data)return t.data.length+4;switch(sr.toCode(t.code)){case 8:let r=t.sourcePrefixLength||0;return Math.ceil(r/8)+8;case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+t.tags.length*2}throw new Error(`Unknown roption code: ${t.code}`)};var Y=C.opt={};Y.encode=function(t,e,r){e||(e=O.alloc(Y.encodingLength(t))),r||(r=0);let n=r,s=De(t,G);return e.writeUInt16BE(s,r),r=Ke(t,G,e,r+2),Y.encode.bytes=r-n,e};Y.encode.bytes=0;Y.decode=function(t,e){e||(e=0);let r=e,n=[],s=t.readUInt16BE(e);e+=2;let i=0;for(;s>0;)n[i++]=G.decode(t,e),e+=G.decode.bytes,s-=G.decode.bytes;return Y.decode.bytes=e-r,n};Y.decode.bytes=0;Y.encodingLength=function(t){return 2+De(t||[],G)};var M=C.dnskey={};M.PROTOCOL_DNSSEC=3;M.ZONE_KEY=128;M.SECURE_ENTRYPOINT=32768;M.encode=function(t,e,r){e||(e=O.alloc(M.encodingLength(t))),r||(r=0);let n=r,s=t.key;if(!O.isBuffer(s))throw new Error("Key must be a Buffer");return r+=2,e.writeUInt16BE(t.flags,r),r+=2,e.writeUInt8(M.PROTOCOL_DNSSEC,r),r+=1,e.writeUInt8(t.algorithm,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,M.encode.bytes=r-n,e.writeUInt16BE(M.encode.bytes-2,n),e};M.encode.bytes=0;M.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);if(e+=2,n.flags=t.readUInt16BE(e),e+=2,t.readUInt8(e)!==M.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t.readUInt8(e),e+=1,n.key=t.slice(e,r+s+2),e+=n.key.length,M.decode.bytes=e-r,n};M.decode.bytes=0;M.encodingLength=function(t){return 6+O.byteLength(t.key)};var se=C.rrsig={};se.encode=function(t,e,r){e||(e=O.alloc(se.encodingLength(t))),r||(r=0);let n=r,s=t.signature;if(!O.isBuffer(s))throw new Error("Signature must be a Buffer");return r+=2,e.writeUInt16BE(be.toType(t.typeCovered),r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.labels,r),r+=1,e.writeUInt32BE(t.originalTTL,r),r+=4,e.writeUInt32BE(t.expiration,r),r+=4,e.writeUInt32BE(t.inception,r),r+=4,e.writeUInt16BE(t.keyTag,r),r+=2,w.encode(t.signersName,e,r),r+=w.encode.bytes,s.copy(e,r,0,s.length),r+=s.length,se.encode.bytes=r-n,e.writeUInt16BE(se.encode.bytes-2,n),e};se.encode.bytes=0;se.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.typeCovered=be.toString(t.readUInt16BE(e)),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.labels=t.readUInt8(e),e+=1,n.originalTTL=t.readUInt32BE(e),e+=4,n.expiration=t.readUInt32BE(e),e+=4,n.inception=t.readUInt32BE(e),e+=4,n.keyTag=t.readUInt16BE(e),e+=2,n.signersName=w.decode(t,e),e+=w.decode.bytes,n.signature=t.slice(e,r+s+2),e+=n.signature.length,se.decode.bytes=e-r,n};se.decode.bytes=0;se.encodingLength=function(t){return 20+w.encodingLength(t.signersName)+O.byteLength(t.signature)};var ie=C.rp={};ie.encode=function(t,e,r){e||(e=O.alloc(ie.encodingLength(t))),r||(r=0);let n=r;return r+=2,w.encode(t.mbox||".",e,r,{mail:!0}),r+=w.encode.bytes,w.encode(t.txt||".",e,r),r+=w.encode.bytes,ie.encode.bytes=r-n,e.writeUInt16BE(ie.encode.bytes-2,n),e};ie.encode.bytes=0;ie.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.mbox=w.decode(t,e,{mail:!0})||".",e+=w.decode.bytes,n.txt=w.decode(t,e)||".",e+=w.decode.bytes,ie.decode.bytes=e-r,n};ie.decode.bytes=0;ie.encodingLength=function(t){return 2+w.encodingLength(t.mbox||".")+w.encodingLength(t.txt||".")};var B={};B.encode=function(t,e,r){e||(e=O.alloc(B.encodingLength(t))),r||(r=0);let n=r;for(var s=[],i=0;i<t.length;i++){var o=be.toType(t[i]);s[o>>8]===void 0&&(s[o>>8]=[]),s[o>>8][o>>3&31]|=1<<7-(o&7)}for(i=0;i<s.length;i++)if(s[i]!==void 0){var a=O.from(s[i]);e.writeUInt8(i,r),r+=1,e.writeUInt8(a.length,r),r+=1,a.copy(e,r),r+=a.length}return B.encode.bytes=r-n,e};B.encode.bytes=0;B.decode=function(t,e,r){e||(e=0);let n=e;for(var s=[];e-n<r;){var i=t.readUInt8(e);e+=1;var o=t.readUInt8(e);e+=1;for(var a=0;a<o;a++)for(var h=t.readUInt8(e+a),m=0;m<8;m++)if(h&1<<7-m){var b=be.toString(i<<8|a<<3|m);s.push(b)}e+=o}return B.decode.bytes=e-n,s};B.decode.bytes=0;B.encodingLength=function(t){for(var e=[],r=0;r<t.length;r++){var n=be.toType(t[r]);e[n>>8]=Math.max(e[n>>8]||0,n&255)}var s=0;for(r=0;r<e.length;r++)e[r]!==void 0&&(s+=2+Math.ceil((e[r]+1)/8));return s};var oe=C.nsec={};oe.encode=function(t,e,r){e||(e=O.alloc(oe.encodingLength(t))),r||(r=0);let n=r;return r+=2,w.encode(t.nextDomain,e,r),r+=w.encode.bytes,B.encode(t.rrtypes,e,r),r+=B.encode.bytes,oe.encode.bytes=r-n,e.writeUInt16BE(oe.encode.bytes-2,n),e};oe.encode.bytes=0;oe.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.nextDomain=w.decode(t,e),e+=w.decode.bytes,n.rrtypes=B.decode(t,e,s-(e-r)),e+=B.decode.bytes,oe.decode.bytes=e-r,n};oe.decode.bytes=0;oe.encodingLength=function(t){return 2+w.encodingLength(t.nextDomain)+B.encodingLength(t.rrtypes)};var ae=C.nsec3={};ae.encode=function(t,e,r){e||(e=O.alloc(ae.encodingLength(t))),r||(r=0);let n=r,s=t.salt;if(!O.isBuffer(s))throw new Error("salt must be a Buffer");let i=t.nextDomain;if(!O.isBuffer(i))throw new Error("nextDomain must be a Buffer");return r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.flags,r),r+=1,e.writeUInt16BE(t.iterations,r),r+=2,e.writeUInt8(s.length,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,e.writeUInt8(i.length,r),r+=1,i.copy(e,r,0,i.length),r+=i.length,B.encode(t.rrtypes,e,r),r+=B.encode.bytes,ae.encode.bytes=r-n,e.writeUInt16BE(ae.encode.bytes-2,n),e};ae.encode.bytes=0;ae.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);e+=2,n.algorithm=t.readUInt8(e),e+=1,n.flags=t.readUInt8(e),e+=1,n.iterations=t.readUInt16BE(e),e+=2;let i=t.readUInt8(e);e+=1,n.salt=t.slice(e,e+i),e+=i;let o=t.readUInt8(e);return e+=1,n.nextDomain=t.slice(e,e+o),e+=o,n.rrtypes=B.decode(t,e,s-(e-r)),e+=B.decode.bytes,ae.decode.bytes=e-r,n};ae.decode.bytes=0;ae.encodingLength=function(t){return 8+t.salt.length+t.nextDomain.length+B.encodingLength(t.rrtypes)};var ce=C.ds={};ce.encode=function(t,e,r){e||(e=O.alloc(ce.encodingLength(t))),r||(r=0);let n=r,s=t.digest;if(!O.isBuffer(s))throw new Error("Digest must be a Buffer");return r+=2,e.writeUInt16BE(t.keyTag,r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.digestType,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,ce.encode.bytes=r-n,e.writeUInt16BE(ce.encode.bytes-2,n),e};ce.encode.bytes=0;ce.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.keyTag=t.readUInt16BE(e),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.digestType=t.readUInt8(e),e+=1,n.digest=t.slice(e,r+s+2),e+=n.digest.length,ce.decode.bytes=e-r,n};ce.decode.bytes=0;ce.encodingLength=function(t){return 6+O.byteLength(t.digest)};var K=C.sshfp={};K.getFingerprintLengthForHashType=function(e){switch(e){case 1:return 20;case 2:return 32}};K.encode=function(e,r,n){r||(r=O.alloc(K.encodingLength(e))),n||(n=0);let s=n;n+=2,r[n]=e.algorithm,n+=1,r[n]=e.hash,n+=1;let i=O.from(e.fingerprint.toUpperCase(),"hex");if(i.length!==K.getFingerprintLengthForHashType(e.hash))throw new Error("Invalid fingerprint length");return i.copy(r,n),n+=i.byteLength,K.encode.bytes=n-s,r.writeUInt16BE(K.encode.bytes-2,s),r};K.encode.bytes=0;K.decode=function(e,r){r||(r=0);let n=r,s={};r+=2,s.algorithm=e[r],r+=1,s.hash=e[r],r+=1;let i=K.getFingerprintLengthForHashType(s.hash);return s.fingerprint=e.slice(r,r+i).toString("hex").toUpperCase(),r+=i,K.decode.bytes=r-n,s};K.decode.bytes=0;K.encodingLength=function(t){return 4+O.from(t.fingerprint,"hex").byteLength};var de=C.naptr={};de.encode=function(t,e,r){e||(e=O.alloc(de.encodingLength(t))),r||(r=0);let n=r;return r+=2,e.writeUInt16BE(t.order||0,r),r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,T.encode(t.flags,e,r),r+=T.encode.bytes,T.encode(t.services,e,r),r+=T.encode.bytes,T.encode(t.regexp,e,r),r+=T.encode.bytes,w.encode(t.replacement,e,r),r+=w.encode.bytes,de.encode.bytes=r-n,e.writeUInt16BE(de.encode.bytes-2,n),e};de.encode.bytes=0;de.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.order=t.readUInt16BE(e),e+=2,n.preference=t.readUInt16BE(e),e+=2,n.flags=T.decode(t,e),e+=T.decode.bytes,n.services=T.decode(t,e),e+=T.decode.bytes,n.regexp=T.decode(t,e),e+=T.decode.bytes,n.replacement=w.decode(t,e),e+=w.decode.bytes,de.decode.bytes=e-r,n};de.decode.bytes=0;de.encodingLength=function(t){return T.encodingLength(t.flags)+T.encodingLength(t.services)+T.encodingLength(t.regexp)+w.encodingLength(t.replacement)+6};var he=C.tlsa={};he.encode=function(t,e,r){e||(e=O.alloc(he.encodingLength(t))),r||(r=0);let n=r,s=t.certificate;if(!O.isBuffer(s))throw new Error("Certificate must be a Buffer");return r+=2,e.writeUInt8(t.usage,r),r+=1,e.writeUInt8(t.selector,r),r+=1,e.writeUInt8(t.matchingType,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,he.encode.bytes=r-n,e.writeUInt16BE(he.encode.bytes-2,n),e};he.encode.bytes=0;he.decode=function(t,e){e||(e=0);let r=e,n={},s=t.readUInt16BE(e);return e+=2,n.usage=t.readUInt8(e),e+=1,n.selector=t.readUInt8(e),e+=1,n.matchingType=t.readUInt8(e),e+=1,n.certificate=t.slice(e,r+s+2),e+=n.certificate.length,he.decode.bytes=e-r,n};he.decode.bytes=0;he.encodingLength=function(t){return 5+O.byteLength(t.certificate)};var or=C.record=function(t){switch(t.toUpperCase()){case"A":return _e;case"PTR":return X;case"CNAME":return bo;case"DNAME":return Eo;case"TXT":return pe;case"NULL":return ye;case"AAAA":return we;case"SRV":return fe;case"HINFO":return ge;case"CAA":return W;case"NS":return le;case"SOA":return me;case"MX":return Ce;case"OPT":return Y;case"DNSKEY":return M;case"RRSIG":return se;case"RP":return ie;case"NSEC":return oe;case"NSEC3":return ae;case"SSHFP":return K;case"DS":return ce;case"NAPTR":return de;case"TLSA":return he}return ue},$=C.answer={};$.encode=function(t,e,r){e||(e=O.alloc($.encodingLength(t))),r||(r=0);let n=r;if(w.encode(t.name,e,r),r+=w.encode.bytes,e.writeUInt16BE(be.toType(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");e.writeUInt16BE(t.udpPayloadSize||4096,r+2),e.writeUInt8(t.extendedRcode||0,r+4),e.writeUInt8(t.ednsVersion||0,r+5),e.writeUInt16BE(t.flags||0,r+6),r+=8,Y.encode(t.options||[],e,r),r+=Y.encode.bytes}else{let s=St.toClass(t.class===void 0?"IN":t.class);t.flush&&(s|=ir),e.writeUInt16BE(s,r+2),e.writeUInt32BE(t.ttl||0,r+4),r+=8;let i=or(t.type);i.encode(t.data,e,r),r+=i.encode.bytes}return $.encode.bytes=r-n,e};$.encode.bytes=0;$.decode=function(t,e){e||(e=0);let r={},n=e;if(r.name=w.decode(t,e),e+=w.decode.bytes,r.type=be.toString(t.readUInt16BE(e)),r.type==="OPT")r.udpPayloadSize=t.readUInt16BE(e+2),r.extendedRcode=t.readUInt8(e+4),r.ednsVersion=t.readUInt8(e+5),r.flags=t.readUInt16BE(e+6),r.flag_do=(r.flags>>15&1)===1,r.options=Y.decode(t,e+8),e+=8+Y.decode.bytes;else{let s=t.readUInt16BE(e+2);r.ttl=t.readUInt32BE(e+4),r.class=St.toString(s&_o),r.flush=!!(s&ir);let i=or(r.type);r.data=i.decode(t,e+8),e+=8+i.decode.bytes}return $.decode.bytes=e-n,r};$.decode.bytes=0;$.encodingLength=function(t){let e=t.data!==null&&t.data!==void 0?t.data:t.options;return w.encodingLength(t.name)+8+or(t.type).encodingLength(e)};var Z=C.question={};Z.encode=function(t,e,r){e||(e=O.alloc(Z.encodingLength(t))),r||(r=0);let n=r;return w.encode(t.name,e,r),r+=w.encode.bytes,e.writeUInt16BE(be.toType(t.type),r),r+=2,e.writeUInt16BE(St.toClass(t.class===void 0?"IN":t.class),r),r+=2,Z.encode.bytes=r-n,t};Z.encode.bytes=0;Z.decode=function(t,e){e||(e=0);let r=e,n={};return n.name=w.decode(t,e),e+=w.decode.bytes,n.type=be.toString(t.readUInt16BE(e)),e+=2,n.class=St.toString(t.readUInt16BE(e)),e+=2,!!(n.class&Ln)&&(n.class&=wo),Z.decode.bytes=e-r,n};Z.decode.bytes=0;Z.encodingLength=function(t){return w.encodingLength(t.name)+4};C.AUTHORITATIVE_ANSWER=1024;C.TRUNCATED_RESPONSE=512;C.RECURSION_DESIRED=256;C.RECURSION_AVAILABLE=128;C.AUTHENTIC_DATA=32;C.CHECKING_DISABLED=16;C.DNSSEC_OK=32768;C.encode=function(t,e,r){let n=!e;n&&(e=O.alloc(C.encodingLength(t))),r||(r=0);let s=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),ee.encode(t,e,r),r+=ee.encode.bytes,r=Ke(t.questions,Z,e,r),r=Ke(t.answers,$,e,r),r=Ke(t.authorities,$,e,r),r=Ke(t.additionals,$,e,r),C.encode.bytes=r-s,n&&C.encode.bytes!==e.length?e.slice(0,C.encode.bytes):e};C.encode.bytes=0;C.decode=function(t,e){e||(e=0);let r=e,n=ee.decode(t,e);return e+=ee.decode.bytes,e=Et(n.questions,Z,t,e),e=Et(n.answers,$,t,e),e=Et(n.authorities,$,t,e),e=Et(n.additionals,$,t,e),C.decode.bytes=e-r,n};C.decode.bytes=0;C.encodingLength=function(t){return ee.encodingLength(t)+De(t.questions||[],Z)+De(t.answers||[],$)+De(t.authorities||[],$)+De(t.additionals||[],$)};C.streamEncode=function(t){let e=C.encode(t),r=O.alloc(2);r.writeUInt16BE(e.byteLength);let n=O.concat([r,e]);return C.streamEncode.bytes=n.byteLength,n};C.streamEncode.bytes=0;C.streamDecode=function(t){let e=t.readUInt16BE(0);if(t.byteLength<e+2)return null;let r=C.decode(t.slice(2));return C.streamDecode.bytes=C.decode.bytes,r};C.streamDecode.bytes=0;function De(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function Ke(t,e,r,n){for(let s=0;s<t.length;s++)e.encode(t[s],r,n),n+=e.encode.bytes;return n}function Et(t,e,r,n){for(let s=0;s<t.length;s++)t[s]=e.decode(r,n),n+=e.decode.bytes;return n}});var Hn=I((Bd,Dn)=>{"use strict";var So=require("dgram"),xo=require("util"),te=Nn(),vn=require("events");Dn.exports=A;function A(t){if(!(this instanceof A))return new A(t);t||(t={}),vn.EventEmitter.call(this);let e=this;this.retries=t.retries!==void 0?t.retries:5,this.timeout=t.timeout||7500,this.timeoutChecks=t.timeoutChecks||this.timeout/10,this.destroyed=!1,this.inflight=0,this.maxQueries=t.maxQueries||1e4,this.maxRedirects=t.maxRedirects||0,this.socket=t.socket||So.createSocket("udp4"),this._id=Math.ceil(Math.random()*this.maxQueries),this._queries=new Array(this.maxQueries).fill(null),this._interval=null,this.socket.on("error",r),this.socket.on("message",n),Oo(this.socket)?i():this.socket.on("listening",i),this.socket.on("close",o);function r(a){a.code==="EACCES"||a.code==="EADDRINUSE"?e.emit("error",a):e.emit("warning",a)}function n(a,h){e._onmessage(a,h)}function s(){e._ontimeoutCheck()}function i(){e._interval=setInterval(s,e.timeoutChecks),e.emit("listening")}function o(){e.emit("close")}}xo.inherits(A,vn.EventEmitter);A.RECURSION_DESIRED=A.prototype.RECURSION_DESIRED=te.RECURSION_DESIRED;A.RECURSION_AVAILABLE=A.prototype.RECURSION_AVAILABLE=te.RECURSION_AVAILABLE;A.TRUNCATED_RESPONSE=A.prototype.TRUNCATED_RESPONSE=te.TRUNCATED_RESPONSE;A.AUTHORITATIVE_ANSWER=A.prototype.AUTHORITATIVE_ANSWER=te.AUTHORITATIVE_ANSWER;A.AUTHENTIC_DATA=A.prototype.AUTHENTIC_DATA=te.AUTHENTIC_DATA;A.CHECKING_DISABLED=A.prototype.CHECKING_DISABLED=te.CHECKING_DISABLED;A.prototype.address=function(){return this.socket.address()};A.prototype.bind=function(...t){let e=t.length>0&&t[t.length-1];typeof e=="function"?(this.once("listening",e),this.socket.bind(...t.slice(0,-1))):this.socket.bind(...t)};A.prototype.destroy=function(t){if(t&&this.once("close",t),!this.destroyed){this.destroyed=!0,clearInterval(this._interval),this.socket.close();for(let e=0;e<this.maxQueries;e++){let r=this._queries[e];r&&(r.callback(new Error("Socket destroyed")),this._queries[e]=null)}this.inflight=0}};A.prototype._ontimeoutCheck=function(){let t=Date.now();for(let e=0;e<this.maxQueries;e++){let r=this._queries[e];if(!(!r||t-r.firstTry<(r.tries+1)*this.timeout)){if(r.tries>this.retries){this._queries[e]=null,this.inflight--,this.emit("timeout",r.query,r.port,r.host),r.callback(new Error("Query timed out"));continue}r.tries++,this.socket.send(r.buffer,0,r.buffer.length,r.port,Array.isArray(r.host)?r.host[Math.floor(r.host.length*Math.random())]:r.host||"127.0.0.1")}}};A.prototype._shouldRedirect=function(t,e){if(this.maxRedirects<=0||!t||t.query.questions.length!==1||e.answers.filter(s=>s.type==="A").length>0||t.redirects>this.maxRedirects)return!1;let r=e.answers.filter(s=>s.type==="CNAME");if(r.length===0)return!1;let n=this._getNextEmptyId();return n===-1?(t.callback(new Error("Query array is full!")),!0):(t.query={id:n+1,flags:te.RECURSION_DESIRED,questions:[{type:"A",name:r[0].data}]},t.redirects++,t.firstTry=Date.now(),t.tries=0,t.buffer=te.encode(t.query),this._queries[n]=t,this.socket.send(t.buffer,0,t.buffer.length,t.port,Array.isArray(t.host)?t.host[Math.floor(t.host.length*Math.random())]:t.host||"127.0.0.1"),!0)};A.prototype._onmessage=function(t,e){let r;try{r=te.decode(t)}catch(n){this.emit("warning",n);return}if(r.type==="response"&&r.id){let n=this._queries[r.id-1];n&&(this._queries[r.id-1]=null,this.inflight--,this._shouldRedirect(n,r)||n.callback(null,r))}this.emit(r.type,r,e.port,e.address)};A.prototype.unref=function(){this.socket.unref()};A.prototype.ref=function(){this.socket.ref()};A.prototype.response=function(t,e,r,n){if(this.destroyed)return;e.type="response",e.id=t.id;let s=te.encode(e);this.socket.send(s,0,s.length,r,n)};A.prototype.cancel=function(t){let e=this._queries[t];e&&(this._queries[t]=null,this.inflight--,e.callback(new Error("Query cancelled")))};A.prototype.setRetries=function(t,e){let r=this._queries[t];r&&(r.firstTry=r.firstTry-this.timeout*(e-r.retries),r.retries=this.retries-e)};A.prototype._getNextEmptyId=function(){let t=-1;for(let e=this.maxQueries;e>0;e--){let r=(this._id+e)%this.maxQueries;if(this._queries[r]===null){t=r,this._id=(r+1)%this.maxQueries;break}}return t};A.prototype.query=function(t,e,r,n){if(this.destroyed)return n(new Error("Socket destroyed")),0;this.inflight++,t.type="query",t.flags=typeof t.flags=="number"?t.flags:A.RECURSION_DESIRED;let s=this._getNextEmptyId();if(s===-1)return n(new Error("Query array is full!")),0;t.id=s+1;let i=te.encode(t);return this._queries[s]={callback:n||Co,redirects:0,firstTry:Date.now(),query:t,tries:0,buffer:i,port:e,host:r},this.socket.send(i,0,i.length,e,Array.isArray(r)?r[Math.floor(r.length*Math.random())]:r||"127.0.0.1"),s};function Co(){}function Oo(t){try{return t.address().port!==0}catch{return!1}}});var $n=I((dr,hr)=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});function Bo(t){return t.encrypted}var cr=(t,e)=>{let r;typeof e=="function"?r={connect:e}:r=e;let n=typeof r.connect=="function",s=typeof r.secureConnect=="function",i=typeof r.close=="function",o=()=>{n&&r.connect(),Bo(t)&&s&&(t.authorized?r.secureConnect():t.authorizationError||t.once("secureConnect",r.secureConnect)),i&&t.once("close",r.close)};t.writable&&!t.connecting?o():t.connecting?t.once("connect",o):t.destroyed&&i&&r.close(t._hadError)};dr.default=cr;hr.exports=cr;hr.exports.default=cr});var Wn=I((Gd,Gn)=>{"use strict";var{PassThrough:Go}=require("stream");Gn.exports=t=>{t={...t};let{array:e}=t,{encoding:r}=t,n=r==="buffer",s=!1;e?s=!(r||n):r=r||"utf8",n&&(r=null);let i=new Go({objectMode:s});r&&i.setEncoding(r);let o=0,a=[];return i.on("data",h=>{a.push(h),s?o=a.length:o+=h.length}),i.getBufferedValue=()=>e?a:n?Buffer.concat(a,o):a.join(""),i.getBufferedLength=()=>o,i}});var pr=I((Wd,Xe)=>{"use strict";var{constants:Wo}=require("buffer"),Ko=require("stream"),{promisify:Yo}=require("util"),Qo=Wn(),Jo=Yo(Ko.pipeline),Tt=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function mr(t,e){if(!t)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:r}=e,n=Qo(e);return await new Promise((s,i)=>{let o=a=>{a&&n.getBufferedLength()<=Wo.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),i(a)};(async()=>{try{await Jo(t,n),s()}catch(a){o(a)}})(),n.on("data",()=>{n.getBufferedLength()>r&&o(new Tt)})}),n.getBufferedValue()}Xe.exports=mr;Xe.exports.buffer=(t,e)=>mr(t,{...e,encoding:"buffer"});Xe.exports.array=(t,e)=>mr(t,{...e,array:!0});Xe.exports.MaxBufferError=Tt});var Yn=I((Yd,Kn)=>{"use strict";var Xo=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),Zo=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),ea=new Set([500,502,503,504]),ta={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},ra={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Ee(t){let e=parseInt(t,10);return isFinite(e)?e:0}function na(t){return t?ea.has(t.status):!0}function yr(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[s,i]=n.split(/=/,2);e[s.trim()]=i===void 0?!0:i.trim().replace(/^"|"$/g,"")}return e}function sa(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}Kn.exports=class{constructor(e,r,{shared:n,cacheHeuristic:s,immutableMinTimeToLive:i,ignoreCargoCult:o,_fromObject:a}={}){if(a){this._fromObject(a);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._ignoreCargoCult=!!o,this._cacheHeuristic=s!==void 0?s:.1,this._immutableMinTtl=i!==void 0?i:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=yr(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=yr(e.headers["cache-control"]),this._ignoreCargoCult&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":sa(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&Zo.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||Xo.has(this._status)))}_hasExplicitExpiration(){return!!(this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires)}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){return!this.evaluateRequest(e).revalidation}_evaluateRequestHitResult(e){return{response:{headers:this.responseHeaders()},revalidation:e}}_evaluateRequestRevalidation(e,r){return{synchronous:r,headers:this.revalidationHeaders(e)}}_evaluateRequestMissResult(e){return{response:void 0,revalidation:this._evaluateRequestRevalidation(e,!0)}}evaluateRequest(e){if(this._assertRequestHasHeaders(e),this._rescc["must-revalidate"])return this._evaluateRequestMissResult(e);if(!this._requestMatches(e,!1))return this._evaluateRequestMissResult(e);let r=yr(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)?this._evaluateRequestMissResult(e):r["max-age"]&&this.age()>Ee(r["max-age"])?this._evaluateRequestMissResult(e):r["min-fresh"]&&this.maxAge()-this.age()<Ee(r["min-fresh"])?this._evaluateRequestMissResult(e):this.stale()?"max-stale"in r&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge())?this._evaluateRequestHitResult(void 0):this.useStaleWhileRevalidate()?this._evaluateRequestHitResult(this._evaluateRequestRevalidation(e,!1)):this._evaluateRequestMissResult(e):this._evaluateRequestHitResult(void 0)}_requestMatches(e,r){return!!((!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e))}_allowsStoringAuthenticated(){return!!(this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"])}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)ta[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let s of n)delete r[s]}if(r.warning){let n=r.warning.split(/,/).filter(s=>!/^\s*1[0-9][0-9]/.test(s));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return Ee(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Ee(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Ee(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+Ee(this._rescc["stale-if-error"]),n=e+Ee(this._rescc["stale-while-revalidate"]);return Math.round(Math.max(0,e,r,n)*1e3)}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Ee(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){let e=Ee(this._rescc["stale-while-revalidate"]);return e>0&&this.maxAge()+e>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._ignoreCargoCult=!!e.icc,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,icc:this._ignoreCargoCult,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let s=r["if-none-match"].split(/,/).filter(i=>!/^\s*W\//.test(i));s.length?r["if-none-match"]=s.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&na(r))return{policy:this,modified:!1,matches:!0};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0);let s={shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl,ignoreCargoCult:this._ignoreCargoCult};if(!n)return{policy:new this.constructor(e,r,s),modified:r.status!=304,matches:!1};let i={};for(let a in this._resHeaders)i[a]=a in r.headers&&!ra[a]?r.headers[a]:this._resHeaders[a];let o=Object.assign({},r,{status:this._status,method:this._method,headers:i});return{policy:new this.constructor(e,o,s),modified:!1,matches:!0}}}});var Jn=I(gr=>{gr.stringify=function t(e){if(typeof e>"u")return e;if(e&&Buffer.isBuffer(e))return JSON.stringify(":base64:"+e.toString("base64"));if(e&&e.toJSON&&(e=e.toJSON()),e&&typeof e=="object"){var r="",n=Array.isArray(e);r=n?"[":"{";var s=!0;for(var i in e){var o=typeof e[i]=="function"||!n&&typeof e[i]>"u";Object.hasOwnProperty.call(e,i)&&!o&&(s||(r+=","),s=!1,n?e[i]==null?r+="null":r+=t(e[i]):e[i]!==void 0&&(r+=t(i)+":"+t(e[i])))}return r+=n?"]":"}",r}else return typeof e=="string"?JSON.stringify(/^:/.test(e)?":"+e:e):typeof e>"u"?"null":JSON.stringify(e)};gr.parse=function(t){return JSON.parse(t,function(e,r){return typeof r=="string"?/^:base64:/.test(r)?Buffer.from(r.substring(8),"base64"):/^:/.test(r)?r.substring(1):r:r})}});var ts=I((eh,es)=>{"use strict";var ia=require("events"),Xn=Jn(),oa=t=>{let e={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(t.adapter||t.uri){let r=t.adapter||/^[^:+]*/.exec(t.uri)[0];return new(require(e[r]))(t)}return new Map},Zn=["sqlite","postgres","mysql","mongo","redis","tiered"],fr=class extends ia{constructor(e,{emitErrors:r=!0,...n}={}){if(super(),this.opts={namespace:"keyv",serialize:Xn.stringify,deserialize:Xn.parse,...typeof e=="string"?{uri:e}:e,...n},!this.opts.store){let i={...this.opts};this.opts.store=oa(i)}if(this.opts.compression){let i=this.opts.compression;this.opts.serialize=i.serialize.bind(i),this.opts.deserialize=i.deserialize.bind(i)}typeof this.opts.store.on=="function"&&r&&this.opts.store.on("error",i=>this.emit("error",i)),this.opts.store.namespace=this.opts.namespace;let s=i=>async function*(){for await(let[o,a]of typeof i=="function"?i(this.opts.store.namespace):i){let h=await this.opts.deserialize(a);if(!(this.opts.store.namespace&&!o.includes(this.opts.store.namespace))){if(typeof h.expires=="number"&&Date.now()>h.expires){this.delete(o);continue}yield[this._getKeyUnprefix(o),h.value]}}};typeof this.opts.store[Symbol.iterator]=="function"&&this.opts.store instanceof Map?this.iterator=s(this.opts.store):typeof this.opts.store.iterator=="function"&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=s(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return Zn.includes(this.opts.store.opts.dialect)||Zn.findIndex(e=>this.opts.store.opts.url.includes(e))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map(r=>`${this.opts.namespace}:${r}`)}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,r){let{store:n}=this.opts,s=Array.isArray(e),i=s?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(s&&n.getMany===void 0){let o=[];for(let a of i)o.push(Promise.resolve().then(()=>n.get(a)).then(h=>typeof h=="string"?this.opts.deserialize(h):this.opts.compression?this.opts.deserialize(h):h).then(h=>{if(h!=null)return typeof h.expires=="number"&&Date.now()>h.expires?this.delete(a).then(()=>{}):r&&r.raw?h:h.value}));return Promise.allSettled(o).then(a=>{let h=[];for(let m of a)h.push(m.value);return h})}return Promise.resolve().then(()=>s?n.getMany(i):n.get(i)).then(o=>typeof o=="string"?this.opts.deserialize(o):this.opts.compression?this.opts.deserialize(o):o).then(o=>{if(o!=null)return s?o.map((a,h)=>{if(typeof a=="string"&&(a=this.opts.deserialize(a)),a!=null){if(typeof a.expires=="number"&&Date.now()>a.expires){this.delete(e[h]).then(()=>{});return}return r&&r.raw?a:a.value}}):typeof o.expires=="number"&&Date.now()>o.expires?this.delete(e).then(()=>{}):r&&r.raw?o:o.value})}set(e,r,n){let s=this._getKeyPrefix(e);typeof n>"u"&&(n=this.opts.ttl),n===0&&(n=void 0);let{store:i}=this.opts;return Promise.resolve().then(()=>{let o=typeof n=="number"?Date.now()+n:null;return typeof r=="symbol"&&this.emit("error","symbol cannot be serialized"),r={value:r,expires:o},this.opts.serialize(r)}).then(o=>i.set(s,o,n)).then(()=>!0)}delete(e){let{store:r}=this.opts;if(Array.isArray(e)){let s=this._getKeyPrefixArray(e);if(r.deleteMany===void 0){let i=[];for(let o of s)i.push(r.delete(o));return Promise.allSettled(i).then(o=>o.every(a=>a.value===!0))}return Promise.resolve().then(()=>r.deleteMany(s))}let n=this._getKeyPrefix(e);return Promise.resolve().then(()=>r.delete(n))}clear(){let{store:e}=this.opts;return Promise.resolve().then(()=>e.clear())}has(e){let r=this._getKeyPrefix(e),{store:n}=this.opts;return Promise.resolve().then(async()=>typeof n.has=="function"?n.has(r):await n.get(r)!==void 0)}disconnect(){let{store:e}=this.opts;if(typeof e.disconnect=="function")return e.disconnect()}};es.exports=fr});var cs=I((dh,as)=>{"use strict";var ua=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];as.exports=(t,e)=>{if(e._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");let r=new Set(Object.keys(t).concat(ua)),n={};for(let s of r)s in e||(n[s]={get(){let i=t[s];return typeof i=="function"?i.bind(t):i},set(i){t[s]=i},enumerable:!0,configurable:!1});return Object.defineProperties(e,n),t.once("aborted",()=>{e.destroy(),e.emit("aborted")}),t.once("close",()=>{t.complete&&e.readable?e.once("end",()=>{e.emit("close")}):e.emit("close")}),e}});var hs=I((hh,ds)=>{"use strict";var{Transform:la,PassThrough:ma}=require("stream"),Er=require("zlib"),pa=cs();ds.exports=t=>{let e=(t.headers["content-encoding"]||"").toLowerCase();if(!["gzip","deflate","br"].includes(e))return t;let r=e==="br";if(r&&typeof Er.createBrotliDecompress!="function")return t.destroy(new Error("Brotli is not supported on Node.js < 12")),t;let n=!0,s=new la({transform(a,h,m){n=!1,m(null,a)},flush(a){a()}}),i=new ma({autoDestroy:!1,destroy(a,h){t.destroy(),h(a)}}),o=r?Er.createBrotliDecompress():Er.createUnzip();return o.once("error",a=>{if(n&&!t.readable){i.end();return}i.destroy(a)}),pa(t,i),t.pipe(s).pipe(o).pipe(i),i}});var Ur=I((Gh,Ts)=>{"use strict";var kr=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,r){if(this.cache.set(e,r),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(let[n,s]of this.oldCache.entries())this.onEviction(n,s);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){let r=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,r),r}}set(e,r){return this.cache.has(e)?this.cache.set(e,r):this._set(e,r),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){let r=this.cache.delete(e);return r&&this._size--,this.oldCache.delete(e)||r}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache)yield e;for(let e of this.oldCache){let[r]=e;this.cache.has(r)||(yield e)}}get size(){let e=0;for(let r of this.oldCache.keys())this.cache.has(r)||e++;return Math.min(this._size+e,this.maxSize)}};Ts.exports=kr});var Lr=I((Wh,Ps)=>{"use strict";Ps.exports=t=>{if(t.listenerCount("error")!==0)return t;t.__destroy=t._destroy,t._destroy=(...r)=>{let n=r.pop();t.__destroy(...r,async s=>{await Promise.resolve(),n(s)})};let e=r=>{Promise.resolve().then(()=>{t.emit("error",r)})};return t.once("error",e),Promise.resolve().then(()=>{t.off("error",e)}),t}});var Ue=I((Kh,vs)=>{"use strict";var{URL:As}=require("url"),Ia=require("events"),Ta=require("tls"),Pa=require("http2"),Aa=Ur(),ka=Lr(),F=Symbol("currentStreamCount"),ks=Symbol("request"),V=Symbol("cachedOriginSet"),Te=Symbol("gracefullyClosing"),qt=Symbol("length"),Us=["createConnection","maxDeflateDynamicTableSize","maxSettings","maxSessionMemory","maxHeaderListPairs","maxOutstandingPings","maxReservedRemoteStreams","maxSendHeaderBlockLength","paddingStrategy","peerMaxConcurrentStreams","settings","family","localAddress","rejectUnauthorized","pskCallback","minDHSize","path","socket","ca","cert","sigalgs","ciphers","clientCertEngine","crl","dhparam","ecdhCurve","honorCipherOrder","key","privateKeyEngine","privateKeyIdentifier","maxVersion","minVersion","pfx","secureOptions","secureProtocol","sessionIdContext","ticketKeys"],Ua=(t,e,r)=>{let n=0,s=t.length;for(;n<s;){let i=n+s>>>1;r(t[i],e)?n=i+1:s=i}return n},La=(t,e)=>t.remoteSettings.maxConcurrentStreams>e.remoteSettings.maxConcurrentStreams,Nr=(t,e)=>{for(let r=0;r<t.length;r++){let n=t[r];n[V].length>0&&n[V].length<e[V].length&&n[V].every(s=>e[V].includes(s))&&n[F]+e[F]<=e.remoteSettings.maxConcurrentStreams&&Ns(n)}},Ls=(t,e)=>{for(let r=0;r<t.length;r++){let n=t[r];if(e[V].length>0&&e[V].length<n[V].length&&e[V].every(s=>n[V].includes(s))&&e[F]+n[F]<=n.remoteSettings.maxConcurrentStreams)return Ns(e),!0}return!1},Ns=t=>{t[Te]=!0,t[F]===0&&t.close()},Me=class t extends Ia{constructor({timeout:e=0,maxSessions:r=Number.POSITIVE_INFINITY,maxEmptySessions:n=10,maxCachedTlsSessions:s=100}={}){super(),this.sessions={},this.queue={},this.timeout=e,this.maxSessions=r,this.maxEmptySessions=n,this._emptySessionCount=0,this._sessionCount=0,this.settings={enablePush:!1,initialWindowSize:1024*1024*32},this.tlsSessionCache=new Aa({maxSize:s})}get protocol(){return"https:"}normalizeOptions(e){let r="";for(let n=0;n<Us.length;n++){let s=Us[n];r+=":",e&&e[s]!==void 0&&(r+=e[s])}return r}_processQueue(){if(this._sessionCount>=this.maxSessions){this.closeEmptySessions(this.maxSessions-this._sessionCount+1);return}for(let e in this.queue)for(let r in this.queue[e]){let n=this.queue[e][r];n.completed||(n.completed=!0,n())}}_isBetterSession(e,r){return e>r}_accept(e,r,n,s){let i=0;for(;i<r.length&&e[F]<e.remoteSettings.maxConcurrentStreams;)r[i].resolve(e),i++;r.splice(0,i),r.length>0&&(this.getSession(n,s,r),r.length=0)}getSession(e,r,n){return new Promise((s,i)=>{Array.isArray(n)&&n.length>0?(n=[...n],s()):n=[{resolve:s,reject:i}];try{if(typeof e=="string")e=new As(e);else if(!(e instanceof As))throw new TypeError("The `origin` argument needs to be a string or an URL object");if(r){let{servername:b}=r,{hostname:x}=e;if(b&&x!==b)throw new Error(`Origin ${x} differs from servername ${b}`)}}catch(b){for(let x=0;x<n.length;x++)n[x].reject(b);return}let o=this.normalizeOptions(r),a=e.origin;if(o in this.sessions){let b=this.sessions[o],x=-1,y=-1,p;for(let l=0;l<b.length;l++){let u=b[l],S=u.remoteSettings.maxConcurrentStreams;if(S<x)break;if(!u[V].includes(a))continue;let _=u[F];_>=S||u[Te]||u.destroyed||(p||(x=S),this._isBetterSession(_,y)&&(p=u,y=_))}if(p){this._accept(p,n,a,r);return}}if(o in this.queue){if(a in this.queue[o]){this.queue[o][a].listeners.push(...n);return}}else this.queue[o]={[qt]:0};let h=()=>{o in this.queue&&this.queue[o][a]===m&&(delete this.queue[o][a],--this.queue[o][qt]===0&&delete this.queue[o])},m=async()=>{this._sessionCount++;let b=`${a}:${o}`,x=!1,y;try{let p={...r};p.settings===void 0&&(p.settings=this.settings),p.session===void 0&&(p.session=this.tlsSessionCache.get(b)),y=await(p.createConnection||this.createConnection).call(this,e,p),p.createConnection=()=>y;let u=Pa.connect(e,p);u[F]=0,u[Te]=!1;let S=()=>{let{socket:E}=u,P;return E.servername===!1?(E.servername=E.remoteAddress,P=u.originSet,E.servername=!1):P=u.originSet,P},_=()=>u[F]<u.remoteSettings.maxConcurrentStreams;u.socket.once("session",E=>{this.tlsSessionCache.set(b,E)}),u.once("error",E=>{for(let P=0;P<n.length;P++)n[P].reject(E);this.tlsSessionCache.delete(b)}),u.setTimeout(this.timeout,()=>{u.destroy()}),u.once("close",()=>{if(this._sessionCount--,x){this._emptySessionCount--;let E=this.sessions[o];E.length===1?delete this.sessions[o]:E.splice(E.indexOf(u),1)}else{h();let E=new Error("Session closed without receiving a SETTINGS frame");E.code="HTTP2WRAPPER_NOSETTINGS";for(let P=0;P<n.length;P++)n[P].reject(E)}this._processQueue()});let R=()=>{let E=this.queue[o];if(!E)return;let P=u[V];for(let U=0;U<P.length;U++){let N=P[U];if(N in E){let{listeners:xe,completed:so}=E[N],wt=0;for(;wt<xe.length&&_();)xe[wt].resolve(u),wt++;if(E[N].listeners.splice(0,wt),E[N].listeners.length===0&&!so&&(delete E[N],--E[qt]===0)){delete this.queue[o];break}if(!_())break}}};u.on("origin",()=>{u[V]=S()||[],u[Te]=!1,Ls(this.sessions[o],u),!(u[Te]||!_())&&(R(),_()&&Nr(this.sessions[o],u))}),u.once("remoteSettings",()=>{if(m.destroyed){let E=new Error("Agent has been destroyed");for(let P=0;P<n.length;P++)n[P].reject(E);u.destroy();return}if(u.setLocalWindowSize&&u.setLocalWindowSize(1024*1024*4),u[V]=S()||[],u.socket.encrypted){let E=u[V][0];if(E!==a){let P=new Error(`Requested origin ${a} does not match server ${E}`);for(let U=0;U<n.length;U++)n[U].reject(P);u.destroy();return}}h();{let E=this.sessions;if(o in E){let P=E[o];P.splice(Ua(P,u,La),0,u)}else E[o]=[u]}x=!0,this._emptySessionCount++,this.emit("session",u),this._accept(u,n,a,r),u[F]===0&&this._emptySessionCount>this.maxEmptySessions&&this.closeEmptySessions(this._emptySessionCount-this.maxEmptySessions),u.on("remoteSettings",()=>{_()&&(R(),_()&&Nr(this.sessions[o],u))})}),u[ks]=u.request,u.request=(E,P)=>{if(u[Te])throw new Error("The session is gracefully closing. No new streams are allowed.");let U=u[ks](E,P);return u.ref(),u[F]++===0&&this._emptySessionCount--,U.once("close",()=>{if(--u[F]===0&&(this._emptySessionCount++,u.unref(),this._emptySessionCount>this.maxEmptySessions||u[Te])){u.close();return}u.destroyed||u.closed||_()&&!Ls(this.sessions[o],u)&&(Nr(this.sessions[o],u),R(),u[F]===0&&this._processQueue())}),U}}catch(p){h(),this._sessionCount--;for(let l=0;l<n.length;l++)n[l].reject(p)}};m.listeners=n,m.completed=!1,m.destroyed=!1,this.queue[o][a]=m,this.queue[o][qt]++,this._processQueue()})}request(e,r,n,s){return new Promise((i,o)=>{this.getSession(e,r,[{reject:o,resolve:a=>{try{let h=a.request(n,s);ka(h),i(h)}catch(h){o(h)}}}])})}async createConnection(e,r){return t.connect(e,r)}static connect(e,r){r.ALPNProtocols=["h2"];let n=e.port||443,s=e.hostname;typeof r.servername>"u"&&(r.servername=s);let i=Ta.connect(n,s,r);return r.socket&&(i._peername={family:void 0,address:void 0,port:n}),i}closeEmptySessions(e=Number.POSITIVE_INFINITY){let r=0,{sessions:n}=this;for(let s in n){let i=n[s];for(let o=0;o<i.length;o++){let a=i[o];if(a[F]===0&&(r++,a.close(),r>=e))return r}}return r}destroy(e){let{sessions:r,queue:n}=this;for(let s in r){let i=r[s];for(let o=0;o<i.length;o++)i[o].destroy(e)}for(let s in n){let i=n[s];for(let o in i)i[o].destroyed=!0}this.queue={},this.tlsSessionCache.clear()}get emptySessionCount(){return this._emptySessionCount}get pendingSessionCount(){return this._sessionCount-this._emptySessionCount}get sessionCount(){return this._sessionCount}};Me.kCurrentStreamCount=F;Me.kGracefullyClosing=Te;vs.exports={Agent:Me,globalAgent:new Me}});var Dr=I((Yh,Ds)=>{"use strict";var{Readable:Na}=require("stream"),vr=class extends Na{constructor(e,r){super({emitClose:!1,autoDestroy:!0,highWaterMark:r}),this.statusCode=null,this.statusMessage="",this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers={},this.req=null,this.aborted=!1,this.complete=!1,this.upgrade=null,this.rawHeaders=[],this.rawTrailers=[],this.socket=e,this._dumped=!1}get connection(){return this.socket}set connection(e){this.socket=e}_destroy(e,r){this.readableEnded||(this.aborted=!0),r(),this.req._request.destroy(e)}setTimeout(e,r){return this.req.setTimeout(e,r),this}_dump(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())}_read(){this.req&&this.req._request.resume()}};Ds.exports=vr});var qs=I((Qh,Hs)=>{"use strict";Hs.exports=(t,e,r)=>{for(let n of r)t.on(n,(...s)=>e.emit(n,...s))}});var lt=I((Xh,Bs)=>{"use strict";var Le=(t,e,r)=>{Bs.exports[e]=class extends t{constructor(...s){super(typeof r=="string"?r:r(s)),this.name=`${super.name} [${e}]`,this.code=e}}};Le(TypeError,"ERR_INVALID_ARG_TYPE",t=>{let e=t[0].includes(".")?"property":"argument",r=t[1],n=Array.isArray(r);return n&&(r=`${r.slice(0,-1).join(", ")} or ${r.slice(-1)}`),`The "${t[0]}" ${e} must be ${n?"one of":"of"} type ${r}. Received ${typeof t[2]}`});Le(TypeError,"ERR_INVALID_PROTOCOL",t=>`Protocol "${t[0]}" not supported. Expected "${t[1]}"`);Le(Error,"ERR_HTTP_HEADERS_SENT",t=>`Cannot ${t[0]} headers after they are sent to the client`);Le(TypeError,"ERR_INVALID_HTTP_TOKEN",t=>`${t[0]} must be a valid HTTP token [${t[1]}]`);Le(TypeError,"ERR_HTTP_INVALID_HEADER_VALUE",t=>`Invalid value "${t[0]} for header "${t[1]}"`);Le(TypeError,"ERR_INVALID_CHAR",t=>`Invalid character in ${t[0]} [${t[1]}]`);Le(Error,"ERR_HTTP2_NO_SOCKET_MANIPULATION","HTTP/2 sockets should not be directly manipulated (e.g. read and written)")});var $s=I((Zh,js)=>{"use strict";js.exports=t=>{switch(t){case":method":case":scheme":case":authority":case":path":return!0;default:return!1}}});var Hr=I((eu,zs)=>{"use strict";var{ERR_INVALID_HTTP_TOKEN:va}=lt(),Da=$s(),Ha=/^[\^`\-\w!#$%&*+.|~]+$/;zs.exports=t=>{if(typeof t!="string"||!Ha.test(t)&&!Da(t))throw new va("Header name",t)}});var qr=I((tu,Ms)=>{"use strict";var{ERR_HTTP_INVALID_HEADER_VALUE:qa,ERR_INVALID_CHAR:Ba}=lt(),ja=/[^\t\u0020-\u007E\u0080-\u00FF]/;Ms.exports=(t,e)=>{if(typeof e>"u")throw new qa(e,t);if(ja.test(e))throw new Ba("header content",t)}});var Gs=I((ru,Vs)=>{"use strict";var{ERR_HTTP2_NO_SOCKET_MANIPULATION:Fs}=lt(),$a={has(t,e){let r=t.session===void 0?t:t.session.socket;return e in t||e in r},get(t,e){switch(e){case"on":case"once":case"end":case"emit":case"destroy":return t[e].bind(t);case"writable":case"destroyed":return t[e];case"readable":return t.destroyed?!1:t.readable;case"setTimeout":{let{session:r}=t;return r!==void 0?r.setTimeout.bind(r):t.setTimeout.bind(t)}case"write":case"read":case"pause":case"resume":throw new Fs;default:{let r=t.session===void 0?t:t.session.socket,n=r[e];return typeof n=="function"?n.bind(r):n}}},getPrototypeOf(t){return t.session!==void 0?Reflect.getPrototypeOf(t.session.socket):Reflect.getPrototypeOf(t)},set(t,e,r){switch(e){case"writable":case"readable":case"destroyed":case"on":case"once":case"end":case"emit":case"destroy":return t[e]=r,!0;case"setTimeout":{let{session:n}=t;return n===void 0?t.setTimeout=r:n.setTimeout=r,!0}case"write":case"read":case"pause":case"resume":throw new Fs;default:{let n=t.session===void 0?t:t.session.socket;return n[e]=r,!0}}}};Vs.exports=$a});var zr=I((nu,Xs)=>{"use strict";var{URL:Br,urlToHttpOptions:Ws}=require("url"),za=require("http2"),{Writable:Ma}=require("stream"),{Agent:Fa,globalAgent:Va}=Ue(),Ga=Dr(),Wa=qs(),{ERR_INVALID_ARG_TYPE:Bt,ERR_INVALID_PROTOCOL:Ka,ERR_HTTP_HEADERS_SENT:Ks}=lt(),Ya=Hr(),Qa=qr(),Ja=Gs(),{HTTP2_HEADER_STATUS:Ys,HTTP2_HEADER_METHOD:Qs,HTTP2_HEADER_PATH:Js,HTTP2_HEADER_AUTHORITY:mt,HTTP2_METHOD_CONNECT:Xa}=za.constants,z=Symbol("headers"),Fe=Symbol("origin"),pt=Symbol("session"),jr=Symbol("options"),jt=Symbol("flushedHeaders"),Ve=Symbol("jobs"),yt=Symbol("pendingAgentPromise"),$r=class extends Ma{constructor(e,r,n){if(super({autoDestroy:!1,emitClose:!1}),typeof e=="string"?e=Ws(new Br(e)):e instanceof Br?e=Ws(e):e={...e},typeof r=="function"||r===void 0?(n=r,r=e):r=Object.assign(e,r),r.h2session){if(this[pt]=r.h2session,this[pt].destroyed)throw new Error("The session has been closed already");this.protocol=this[pt].socket.encrypted?"https:":"http:"}else if(r.agent===!1)this.agent=new Fa({maxEmptySessions:0});else if(typeof r.agent>"u"||r.agent===null)this.agent=Va;else if(typeof r.agent.request=="function")this.agent=r.agent;else throw new Bt("options.agent",["http2wrapper.Agent-like Object","undefined","false"],r.agent);if(this.agent&&(this.protocol=this.agent.protocol),r.protocol&&r.protocol!==this.protocol)throw new Ka(r.protocol,this.protocol);r.port||(r.port=r.defaultPort||this.agent&&this.agent.defaultPort||443),r.host=r.hostname||r.host||"localhost",delete r.hostname;let{timeout:s}=r;r.timeout=void 0,this[z]=Object.create(null),this[Ve]=[],this[yt]=void 0,this.socket=null,this.connection=null,this.method=r.method||"GET",this.method==="CONNECT"&&(r.path==="/"||r.path===void 0)||(this.path=r.path),this.res=null,this.aborted=!1,this.reusedSocket=!1;let{headers:i}=r;if(i)for(let a in i)this.setHeader(a,i[a]);r.auth&&!("authorization"in this[z])&&(this[z].authorization="Basic "+Buffer.from(r.auth).toString("base64")),r.session=r.tlsSession,r.path=r.socketPath,this[jr]=r,this[Fe]=new Br(`${this.protocol}//${r.servername||r.host}:${r.port}`);let o=r._reuseSocket;o&&(r.createConnection=(...a)=>o.destroyed?this.agent.createConnection(...a):o,this.agent.getSession(this[Fe],this[jr]).catch(()=>{})),s&&this.setTimeout(s),n&&this.once("response",n),this[jt]=!1}get method(){return this[z][Qs]}set method(e){e&&(this[z][Qs]=e.toUpperCase())}get path(){let e=this.method==="CONNECT"?mt:Js;return this[z][e]}set path(e){if(e){let r=this.method==="CONNECT"?mt:Js;this[z][r]=e}}get host(){return this[Fe].hostname}set host(e){}get _mustNotHaveABody(){return this.method==="GET"||this.method==="HEAD"||this.method==="DELETE"}_write(e,r,n){if(this._mustNotHaveABody){n(new Error("The GET, HEAD and DELETE methods must NOT have a body"));return}this.flushHeaders();let s=()=>this._request.write(e,r,n);this._request?s():this[Ve].push(s)}_final(e){this.flushHeaders();let r=()=>{if(this._mustNotHaveABody||this.method==="CONNECT"){e();return}this._request.end(e)};this._request?r():this[Ve].push(r)}abort(){this.res&&this.res.complete||(this.aborted||process.nextTick(()=>this.emit("abort")),this.aborted=!0,this.destroy())}async _destroy(e,r){this.res&&this.res._dump(),this._request?this._request.destroy():process.nextTick(()=>{this.emit("close")});try{await this[yt]}catch(n){this.aborted&&(e=n)}r(e)}async flushHeaders(){if(this[jt]||this.destroyed)return;this[jt]=!0;let e=this.method===Xa,r=n=>{if(this._request=n,this.destroyed){n.destroy();return}e||Wa(n,this,["timeout","continue"]),n.once("error",i=>{this.destroy(i)}),n.once("aborted",()=>{let{res:i}=this;i?(i.aborted=!0,i.emit("aborted"),i.destroy()):this.destroy(new Error("The server aborted the HTTP/2 stream"))});let s=(i,o,a)=>{let h=new Ga(this.socket,n.readableHighWaterMark);this.res=h,h.url=`${this[Fe].origin}${this.path}`,h.req=this,h.statusCode=i[Ys],h.headers=i,h.rawHeaders=a,h.once("end",()=>{h.complete=!0,h.socket=null,h.connection=null}),e?(h.upgrade=!0,this.emit("connect",h,n,Buffer.alloc(0))?this.emit("close"):n.destroy()):(n.on("data",m=>{!h._dumped&&!h.push(m)&&n.pause()}),n.once("end",()=>{this.aborted||h.push(null)}),this.emit("response",h)||h._dump())};n.once("response",s),n.once("headers",i=>this.emit("information",{statusCode:i[Ys]})),n.once("trailers",(i,o,a)=>{let{res:h}=this;if(h===null){s(i,o,a);return}h.trailers=i,h.rawTrailers=a}),n.once("close",()=>{let{aborted:i,res:o}=this;if(o){i&&(o.aborted=!0,o.emit("aborted"),o.destroy());let a=()=>{o.emit("close"),this.destroy(),this.emit("close")};o.readable?o.once("end",a):a();return}if(!this.destroyed){this.destroy(new Error("The HTTP/2 stream has been early terminated")),this.emit("close");return}this.destroy(),this.emit("close")}),this.socket=new Proxy(n,Ja);for(let i of this[Ve])i();this[Ve].length=0,this.emit("socket",this.socket)};if(!(mt in this[z])&&!e&&(this[z][mt]=this[Fe].host),this[pt])try{r(this[pt].request(this[z]))}catch(n){this.destroy(n)}else{this.reusedSocket=!0;try{let n=this.agent.request(this[Fe],this[jr],this[z]);this[yt]=n,r(await n),this[yt]=!1}catch(n){this[yt]=!1,this.destroy(n)}}}get connection(){return this.socket}set connection(e){this.socket=e}getHeaderNames(){return Object.keys(this[z])}hasHeader(e){if(typeof e!="string")throw new Bt("name","string",e);return!!this[z][e.toLowerCase()]}getHeader(e){if(typeof e!="string")throw new Bt("name","string",e);return this[z][e.toLowerCase()]}get headersSent(){return this[jt]}removeHeader(e){if(typeof e!="string")throw new Bt("name","string",e);if(this.headersSent)throw new Ks("remove");delete this[z][e.toLowerCase()]}setHeader(e,r){if(this.headersSent)throw new Ks("set");Ya(e),Qa(e,r);let n=e.toLowerCase();if(n==="connection"){if(r.toLowerCase()==="keep-alive")return;throw new Error(`Invalid 'connection' header: ${r}`)}n==="host"&&this.method==="CONNECT"?this[z][mt]=r:this[z][n]=r}setNoDelay(){}setSocketKeepAlive(){}setTimeout(e,r){let n=()=>this._request.setTimeout(e,r);return this._request?n():this[Ve].push(n),this}get maxHeadersCount(){if(!this.destroyed&&this._request)return this._request.session.localSettings.maxHeaderListSize}set maxHeadersCount(e){}};Xs.exports=$r});var ei=I((su,Zs)=>{"use strict";var Za=require("tls");Zs.exports=(t={},e=Za.connect)=>new Promise((r,n)=>{let s=!1,i,o=async()=>{await h,i.off("timeout",a),i.off("error",n),t.resolveSocket?(r({alpnProtocol:i.alpnProtocol,socket:i,timeout:s}),s&&(await Promise.resolve(),i.emit("timeout"))):(i.destroy(),r({alpnProtocol:i.alpnProtocol,timeout:s}))},a=async()=>{s=!0,o()},h=(async()=>{try{i=await e(t,o),i.on("error",n),i.once("timeout",a)}catch(m){n(m)}})()})});var ri=I((iu,ti)=>{"use strict";var{isIP:ec}=require("net"),tc=require("assert"),rc=t=>{if(t[0]==="["){let r=t.indexOf("]");return tc(r!==-1),t.slice(1,r)}let e=t.indexOf(":");return e===-1?t:t.slice(0,e)};ti.exports=t=>{let e=rc(t);return ec(e)?"":e}});var hi=I((ou,gt)=>{"use strict";var{URL:ni,urlToHttpOptions:si}=require("url"),ii=require("http"),Mr=require("https"),nc=ei(),sc=Ur(),{Agent:ic,globalAgent:oc}=Ue(),ac=zr(),cc=ri(),oi=Lr(),ai=new sc({maxSize:100}),dc=new Map,hc=(t,e,r)=>{e._httpMessage={shouldKeepAlive:!0};let n=()=>{t.emit("free",e,r)};e.on("free",n);let s=()=>{t.removeSocket(e,r)};e.on("close",s);let i=()=>{let{freeSockets:a}=t;for(let h of Object.values(a))if(h.includes(e)){e.destroy();return}};e.on("timeout",i);let o=()=>{t.removeSocket(e,r),e.off("close",s),e.off("free",n),e.off("timeout",i),e.off("agentRemove",o)};e.on("agentRemove",o),t.emit("free",e,r)},ci=(t,e=new Map,r=void 0)=>async n=>{let s=`${n.host}:${n.port}:${n.ALPNProtocols.sort()}`;if(!t.has(s)){if(e.has(s))return{alpnProtocol:(await e.get(s)).alpnProtocol};let{path:i}=n;n.path=n.socketPath;let o=nc(n,r);e.set(s,o);try{let a=await o;return t.set(s,a.alpnProtocol),e.delete(s),n.path=i,a}catch(a){throw e.delete(s),n.path=i,a}}return{alpnProtocol:t.get(s)}},di=ci(ai,dc);gt.exports=async(t,e,r)=>{if(typeof t=="string"?t=si(new ni(t)):t instanceof ni?t=si(t):t={...t},typeof e=="function"||e===void 0?(r=e,e=t):e=Object.assign(t,e),e.ALPNProtocols=e.ALPNProtocols||["h2","http/1.1"],!Array.isArray(e.ALPNProtocols)||e.ALPNProtocols.length===0)throw new Error("The `ALPNProtocols` option must be an Array with at least one entry");e.protocol=e.protocol||"https:";let n=e.protocol==="https:";e.host=e.hostname||e.host||"localhost",e.session=e.tlsSession,e.servername=e.servername||cc(e.headers&&e.headers.host||e.host),e.port=e.port||(n?443:80),e._defaultAgent=n?Mr.globalAgent:ii.globalAgent;let s=e.resolveProtocol||di,{agent:i}=e;if(i!==void 0&&i!==!1&&i.constructor.name!=="Object")throw new Error("The `options.agent` can be only an object `http`, `https` or `http2` properties");if(n){e.resolveSocket=!0;let{socket:o,alpnProtocol:a,timeout:h}=await s(e);if(h){o&&o.destroy();let b=new Error(`Timed out resolving ALPN: ${e.timeout} ms`);throw b.code="ETIMEDOUT",b.ms=e.timeout,b}o&&e.createConnection&&(o.destroy(),o=void 0),delete e.resolveSocket;let m=a==="h2";if(i&&(i=m?i.http2:i.https,e.agent=i),i===void 0&&(i=m?oc:Mr.globalAgent),o)if(i===!1)o.destroy();else{let b=(m?ic:Mr.Agent).prototype.createConnection;i.createConnection===b?m?e._reuseSocket=o:hc(i,o,e):o.destroy()}if(m)return oi(new ac(e,r))}else i&&(e.agent=i.http);return e.headers&&(e.headers={...e.headers},e.headers[":authority"]&&(e.headers.host||(e.headers.host=e.headers[":authority"]),delete e.headers[":authority"]),delete e.headers[":method"],delete e.headers[":scheme"],delete e.headers[":path"]),oi(ii.request(e,r))};gt.exports.protocolCache=ai;gt.exports.resolveProtocol=di;gt.exports.createResolveProtocol=ci});var Fr=I((au,ui)=>{"use strict";var uc=require("stream"),lc=require("tls"),mc=new lc.TLSSocket(new uc.PassThrough)._handle._parentWrap.constructor;ui.exports=mc});var Gr=I((cu,li)=>{"use strict";var Vr=class extends Error{constructor(e,r=""){super(`The proxy server rejected the request with status code ${e} (${r||"empty status message"})`),this.statusCode=e,this.statusMessage=r}};li.exports=Vr});var pi=I((du,mi)=>{"use strict";var pc=(t,e,r)=>{if(!r.some(s=>typeof s==="string"?typeof e===s:e instanceof s)){let s=r.map(i=>typeof i=="string"?i:i.name);throw new TypeError(`Expected '${t}' to be a type of ${s.join(" or ")}, got ${typeof e}`)}};mi.exports=pc});var Wr=I((hu,gi)=>{"use strict";var{URL:yi}=require("url"),$t=pi();gi.exports=(t,e)=>{$t("proxyOptions",e,["object"]),$t("proxyOptions.headers",e.headers,["object","undefined"]),$t("proxyOptions.raw",e.raw,["boolean","undefined"]),$t("proxyOptions.url",e.url,[yi,"string"]);let r=new yi(e.url);t.proxyOptions={raw:!0,...e,headers:{...e.headers},url:r}}});var zt=I((uu,fi)=>{"use strict";fi.exports=t=>{let{username:e,password:r}=t.proxyOptions.url;if(e||r){let n=`${e}:${r}`,s=`Basic ${Buffer.from(n).toString("base64")}`;return{"proxy-authorization":s,authorization:s}}return{}}});var Si=I((lu,Ei)=>{"use strict";var yc=require("tls"),gc=require("http"),_i=require("https"),fc=Fr(),{globalAgent:_c}=Ue(),wc=Gr(),wi=Wr(),bc=zt(),bi=(t,e,r)=>{(async()=>{try{let{proxyOptions:n}=t,{url:s,headers:i,raw:o}=n,a=await _c.request(s,n,{...bc(t),...i,":method":"CONNECT",":authority":`${e.host}:${e.port}`});a.once("error",r),a.once("response",h=>{let m=h[":status"];if(m!==200){r(new wc(m,""));return}let b=t instanceof _i.Agent;if(o&&b){e.socket=a;let y=yc.connect(e);y.once("close",()=>{a.destroy()}),r(null,y);return}let x=new fc(a);x.encrypted=!1,x._handle.getpeername=y=>{y.family=void 0,y.address=void 0,y.port=void 0},r(null,x)})}catch(n){r(n)}})()},Kr=class extends gc.Agent{constructor(e){super(e),wi(this,e.proxyOptions)}createConnection(e,r){bi(this,e,r)}},Yr=class extends _i.Agent{constructor(e){super(e),wi(this,e.proxyOptions)}createConnection(e,r){bi(this,e,r)}};Ei.exports={HttpOverHttp2:Kr,HttpsOverHttp2:Yr}});var Jr=I((mu,xi)=>{"use strict";var{Agent:Ec}=Ue(),Sc=Fr(),xc=Gr(),Cc=Wr(),Qr=class extends Ec{constructor(e){super(e),Cc(this,e.proxyOptions)}async createConnection(e,r){let n=`${e.hostname}:${e.port||443}`,[s,i,o]=await this._getProxyStream(n);if(i!==200)throw new xc(i,o);if(this.proxyOptions.raw)r.socket=s;else{let a=new Sc(s);return a.encrypted=!1,a._handle.getpeername=h=>{h.family=void 0,h.address=void 0,h.port=void 0},a}return super.createConnection(e,r)}};xi.exports=Qr});var Oi=I((pu,Ci)=>{"use strict";var{globalAgent:Oc}=Ue(),Rc=Jr(),Ic=zt(),Tc=t=>new Promise((e,r)=>{t.once("error",r),t.once("response",n=>{t.off("error",r),e(n[":status"])})}),Xr=class extends Rc{async _getProxyStream(e){let{proxyOptions:r}=this,n={...Ic(this),...r.headers,":method":"CONNECT",":authority":e},s=await Oc.request(r.url,r,n),i=await Tc(s);return[s,i,""]}};Ci.exports=Xr});var Ii=I((yu,Ri)=>{"use strict";var Pc=require("http"),Ac=require("https"),kc=Jr(),Uc=zt(),Lc=t=>new Promise((e,r)=>{let n=(s,i,o)=>{i.unshift(o),t.off("error",r),e([i,s.statusCode,s.statusMessage])};t.once("error",r),t.once("connect",n)}),Mt=class extends kc{async _getProxyStream(e){let{proxyOptions:r}=this,{url:n,headers:s}=this.proxyOptions,o=(n.protocol==="https:"?Ac:Pc).request({...r,hostname:n.hostname,port:n.port,path:e,headers:{...Uc(this),...s,host:e},method:"CONNECT"}).end();return Lc(o)}};Ri.exports={Http2OverHttp:Mt,Http2OverHttps:Mt}});var Pi=I((gu,Ti)=>{"use strict";var Nc=require("http2"),{Agent:vc,globalAgent:Dc}=Ue(),Zr=zr(),Hc=Dr(),qc=hi(),{HttpOverHttp2:Bc,HttpsOverHttp2:jc}=Si(),$c=Oi(),{Http2OverHttp:zc,Http2OverHttps:Mc}=Ii(),Fc=Hr(),Vc=qr(),Gc=(t,e,r)=>new Zr(t,e,r),Wc=(t,e,r)=>{let n=new Zr(t,e,r);return n.end(),n};Ti.exports={...Nc,ClientRequest:Zr,IncomingMessage:Hc,Agent:vc,globalAgent:Dc,request:Gc,get:Wc,auto:qc,proxies:{HttpOverHttp2:Bc,HttpsOverHttp2:jc,Http2OverHttp2:$c,Http2OverHttp:zc,Http2OverHttps:Mc},validateHeaderName:Fc,validateHeaderValue:Vc}});var Ed={};uo(Ed,{default:()=>bd});module.exports=lo(Ed);var Jt=D(require("os")),wn=require("@raycast/api");var q=require("@raycast/api");var xd=[q.Icon.Globe,q.Icon.Map,q.Icon.Pin,q.Icon.Clock,q.Icon.EditShape,q.Icon.Network,q.Icon.Building],Cd=[q.Icon.Info,q.Icon.Cd,q.Icon.Globe,q.Icon.BullsEye,q.Icon.Map,q.Icon.Pin,q.Icon.Clock,q.Icon.EditShape,q.Icon.Network,q.Icon.Building];var _n=require("@raycast/api"),{language:mo,showIPv6:Rd,coordinatesFormat:Id}=(0,_n.getPreferenceValues)();var bn=t=>!(t!=null&&String(t).length>0);function En(){let t=Jt.networkInterfaces();for(let e in t){let r=t[e];if(typeof r<"u")for(let n=0;n<r.length;n++){let s=r[n];if(s.family==="IPv4"&&s.address!=="127.0.0.1"&&!s.internal)return s.address}}return null}function Sn(){let t=Jt.networkInterfaces();for(let e in t){let r=t[e];if(typeof r<"u")for(let n=0;n<r.length;n++){let s=r[n];if(s.family==="IPv6"&&s.address!=="::1"&&!s.internal)return s.address}}return null}var po=(t,e)=>{let r=new wn.Cache({namespace:"Args"});if(typeof t<"u")return r.set(e,t),t;{let n=r.get(e);return typeof n<"u"?n:""}},xn=(t,e)=>{if(t.length!==e.length)return{args:[]};{let r=[];for(let n=0;n<t.length;n++)r.push(po(t[n],e[n]));return{args:r}}};var j=require("@raycast/api");var Xi=require("node:util"),Zi=D(require("node:dgram"),1),eo=D(Hn(),1);var qn=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ro(t){return qn.includes(t)}var Io=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Blob","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","WeakRef","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","FormData","URLSearchParams","HTMLElement","NaN",...qn];function To(t){return Io.includes(t)}var Po=["null","undefined","string","number","bigint","boolean","symbol"];function Ao(t){return Po.includes(t)}function He(t){return e=>typeof e===t}var{toString:ko}=Object.prototype,Ye=t=>{let e=ko.call(t).slice(8,-1);if(/HTML\w+Element/.test(e)&&c.domElement(t))return"HTMLElement";if(To(e))return e},k=t=>e=>Ye(e)===t;function c(t){if(t===null)return"null";switch(typeof t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"NaN":"number";case"boolean":return"boolean";case"function":return"Function";case"bigint":return"bigint";case"symbol":return"symbol";default:}if(c.observable(t))return"Observable";if(c.array(t))return"Array";if(c.buffer(t))return"Buffer";let e=Ye(t);if(e)return e;if(t instanceof String||t instanceof Boolean||t instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}c.undefined=He("undefined");c.string=He("string");var Uo=He("number");c.number=t=>Uo(t)&&!c.nan(t);c.positiveNumber=t=>c.number(t)&&t>0;c.negativeNumber=t=>c.number(t)&&t<0;c.bigint=He("bigint");c.function_=He("function");c.null_=t=>t===null;c.class_=t=>c.function_(t)&&t.toString().startsWith("class ");c.boolean=t=>t===!0||t===!1;c.symbol=He("symbol");c.numericString=t=>c.string(t)&&!c.emptyStringOrWhitespace(t)&&!Number.isNaN(Number(t));c.array=(t,e)=>Array.isArray(t)?c.function_(e)?t.every(r=>e(r)):!0:!1;c.buffer=t=>t?.constructor?.isBuffer?.(t)??!1;c.blob=t=>k("Blob")(t);c.nullOrUndefined=t=>c.null_(t)||c.undefined(t);c.object=t=>!c.null_(t)&&(typeof t=="object"||c.function_(t));c.iterable=t=>c.function_(t?.[Symbol.iterator]);c.asyncIterable=t=>c.function_(t?.[Symbol.asyncIterator]);c.generator=t=>c.iterable(t)&&c.function_(t?.next)&&c.function_(t?.throw);c.asyncGenerator=t=>c.asyncIterable(t)&&c.function_(t.next)&&c.function_(t.throw);c.nativePromise=t=>k("Promise")(t);var Lo=t=>c.function_(t?.then)&&c.function_(t?.catch);c.promise=t=>c.nativePromise(t)||Lo(t);c.generatorFunction=k("GeneratorFunction");c.asyncGeneratorFunction=t=>Ye(t)==="AsyncGeneratorFunction";c.asyncFunction=t=>Ye(t)==="AsyncFunction";c.boundFunction=t=>c.function_(t)&&!t.hasOwnProperty("prototype");c.regExp=k("RegExp");c.date=k("Date");c.error=k("Error");c.map=t=>k("Map")(t);c.set=t=>k("Set")(t);c.weakMap=t=>k("WeakMap")(t);c.weakSet=t=>k("WeakSet")(t);c.weakRef=t=>k("WeakRef")(t);c.int8Array=k("Int8Array");c.uint8Array=k("Uint8Array");c.uint8ClampedArray=k("Uint8ClampedArray");c.int16Array=k("Int16Array");c.uint16Array=k("Uint16Array");c.int32Array=k("Int32Array");c.uint32Array=k("Uint32Array");c.float32Array=k("Float32Array");c.float64Array=k("Float64Array");c.bigInt64Array=k("BigInt64Array");c.bigUint64Array=k("BigUint64Array");c.arrayBuffer=k("ArrayBuffer");c.sharedArrayBuffer=k("SharedArrayBuffer");c.dataView=k("DataView");c.enumCase=(t,e)=>Object.values(e).includes(t);c.directInstanceOf=(t,e)=>Object.getPrototypeOf(t)===e.prototype;c.urlInstance=t=>k("URL")(t);c.urlString=t=>{if(!c.string(t))return!1;try{return new URL(t),!0}catch{return!1}};c.truthy=t=>!!t;c.falsy=t=>!t;c.nan=t=>Number.isNaN(t);c.primitive=t=>c.null_(t)||Ao(typeof t);c.integer=t=>Number.isInteger(t);c.safeInteger=t=>Number.isSafeInteger(t);c.plainObject=t=>{if(typeof t!="object"||t===null)return!1;let e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};c.typedArray=t=>Ro(Ye(t));var No=t=>c.safeInteger(t)&&t>=0;c.arrayLike=t=>!c.nullOrUndefined(t)&&!c.function_(t)&&No(t.length);c.tupleLike=(t,e)=>c.array(e)&&c.array(t)&&e.length===t.length?e.every((r,n)=>r(t[n])):!1;c.inRange=(t,e)=>{if(c.number(e))return t>=Math.min(0,e)&&t<=Math.max(e,0);if(c.array(e)&&e.length===2)return t>=Math.min(...e)&&t<=Math.max(...e);throw new TypeError(`Invalid range: ${JSON.stringify(e)}`)};var vo=1,Do=["innerHTML","ownerDocument","style","attributes","nodeValue"];c.domElement=t=>c.object(t)&&t.nodeType===vo&&c.string(t.nodeName)&&!c.plainObject(t)&&Do.every(e=>e in t);c.observable=t=>t?t===t[Symbol.observable]?.()||t===t["@@observable"]?.():!1;c.nodeStream=t=>c.object(t)&&c.function_(t.pipe)&&!c.observable(t);c.infinite=t=>t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY;var Bn=t=>e=>c.integer(e)&&Math.abs(e%2)===t;c.evenInteger=Bn(0);c.oddInteger=Bn(1);c.emptyArray=t=>c.array(t)&&t.length===0;c.nonEmptyArray=t=>c.array(t)&&t.length>0;c.emptyString=t=>c.string(t)&&t.length===0;var Ho=t=>c.string(t)&&!/\S/.test(t);c.emptyStringOrWhitespace=t=>c.emptyString(t)||Ho(t);c.nonEmptyString=t=>c.string(t)&&t.length>0;c.nonEmptyStringAndNotWhitespace=t=>c.string(t)&&!c.emptyStringOrWhitespace(t);c.emptyObject=t=>c.object(t)&&!c.map(t)&&!c.set(t)&&Object.keys(t).length===0;c.nonEmptyObject=t=>c.object(t)&&!c.map(t)&&!c.set(t)&&Object.keys(t).length>0;c.emptySet=t=>c.set(t)&&t.size===0;c.nonEmptySet=t=>c.set(t)&&t.size>0;c.emptyMap=t=>c.map(t)&&t.size===0;c.nonEmptyMap=t=>c.map(t)&&t.size>0;c.propertyKey=t=>c.any([c.string,c.number,c.symbol],t);c.formData=t=>k("FormData")(t);c.urlSearchParams=t=>k("URLSearchParams")(t);var jn=(t,e,r)=>{if(!c.function_(e))throw new TypeError(`Invalid predicate: ${JSON.stringify(e)}`);if(r.length===0)throw new TypeError("Invalid number of values");return t.call(r,e)};c.any=(t,...e)=>(c.array(t)?t:[t]).some(n=>jn(Array.prototype.some,n,e));c.all=(t,...e)=>jn(Array.prototype.every,t,e);var f=(t,e,r,n={})=>{if(!t){let{multipleValues:s}=n,i=s?`received values of types ${[...new Set(r.map(o=>`\`${c(o)}\``))].join(", ")}`:`received value of type \`${c(r)}\``;throw new TypeError(`Expected value which is \`${e}\`, ${i}.`)}},g={undefined:t=>f(c.undefined(t),"undefined",t),string:t=>f(c.string(t),"string",t),number:t=>f(c.number(t),"number",t),positiveNumber:t=>f(c.positiveNumber(t),"positive number",t),negativeNumber:t=>f(c.negativeNumber(t),"negative number",t),bigint:t=>f(c.bigint(t),"bigint",t),function_:t=>f(c.function_(t),"Function",t),null_:t=>f(c.null_(t),"null",t),class_:t=>f(c.class_(t),"Class",t),boolean:t=>f(c.boolean(t),"boolean",t),symbol:t=>f(c.symbol(t),"symbol",t),numericString:t=>f(c.numericString(t),"string with a number",t),array:(t,e)=>{f(c.array(t),"Array",t),e&&t.forEach(e)},buffer:t=>f(c.buffer(t),"Buffer",t),blob:t=>f(c.blob(t),"Blob",t),nullOrUndefined:t=>f(c.nullOrUndefined(t),"null or undefined",t),object:t=>f(c.object(t),"Object",t),iterable:t=>f(c.iterable(t),"Iterable",t),asyncIterable:t=>f(c.asyncIterable(t),"AsyncIterable",t),generator:t=>f(c.generator(t),"Generator",t),asyncGenerator:t=>f(c.asyncGenerator(t),"AsyncGenerator",t),nativePromise:t=>f(c.nativePromise(t),"native Promise",t),promise:t=>f(c.promise(t),"Promise",t),generatorFunction:t=>f(c.generatorFunction(t),"GeneratorFunction",t),asyncGeneratorFunction:t=>f(c.asyncGeneratorFunction(t),"AsyncGeneratorFunction",t),asyncFunction:t=>f(c.asyncFunction(t),"AsyncFunction",t),boundFunction:t=>f(c.boundFunction(t),"Function",t),regExp:t=>f(c.regExp(t),"RegExp",t),date:t=>f(c.date(t),"Date",t),error:t=>f(c.error(t),"Error",t),map:t=>f(c.map(t),"Map",t),set:t=>f(c.set(t),"Set",t),weakMap:t=>f(c.weakMap(t),"WeakMap",t),weakSet:t=>f(c.weakSet(t),"WeakSet",t),weakRef:t=>f(c.weakRef(t),"WeakRef",t),int8Array:t=>f(c.int8Array(t),"Int8Array",t),uint8Array:t=>f(c.uint8Array(t),"Uint8Array",t),uint8ClampedArray:t=>f(c.uint8ClampedArray(t),"Uint8ClampedArray",t),int16Array:t=>f(c.int16Array(t),"Int16Array",t),uint16Array:t=>f(c.uint16Array(t),"Uint16Array",t),int32Array:t=>f(c.int32Array(t),"Int32Array",t),uint32Array:t=>f(c.uint32Array(t),"Uint32Array",t),float32Array:t=>f(c.float32Array(t),"Float32Array",t),float64Array:t=>f(c.float64Array(t),"Float64Array",t),bigInt64Array:t=>f(c.bigInt64Array(t),"BigInt64Array",t),bigUint64Array:t=>f(c.bigUint64Array(t),"BigUint64Array",t),arrayBuffer:t=>f(c.arrayBuffer(t),"ArrayBuffer",t),sharedArrayBuffer:t=>f(c.sharedArrayBuffer(t),"SharedArrayBuffer",t),dataView:t=>f(c.dataView(t),"DataView",t),enumCase:(t,e)=>f(c.enumCase(t,e),"EnumCase",t),urlInstance:t=>f(c.urlInstance(t),"URL",t),urlString:t=>f(c.urlString(t),"string with a URL",t),truthy:t=>f(c.truthy(t),"truthy",t),falsy:t=>f(c.falsy(t),"falsy",t),nan:t=>f(c.nan(t),"NaN",t),primitive:t=>f(c.primitive(t),"primitive",t),integer:t=>f(c.integer(t),"integer",t),safeInteger:t=>f(c.safeInteger(t),"integer",t),plainObject:t=>f(c.plainObject(t),"plain object",t),typedArray:t=>f(c.typedArray(t),"TypedArray",t),arrayLike:t=>f(c.arrayLike(t),"array-like",t),tupleLike:(t,e)=>f(c.tupleLike(t,e),"tuple-like",t),domElement:t=>f(c.domElement(t),"HTMLElement",t),observable:t=>f(c.observable(t),"Observable",t),nodeStream:t=>f(c.nodeStream(t),"Node.js Stream",t),infinite:t=>f(c.infinite(t),"infinite number",t),emptyArray:t=>f(c.emptyArray(t),"empty array",t),nonEmptyArray:t=>f(c.nonEmptyArray(t),"non-empty array",t),emptyString:t=>f(c.emptyString(t),"empty string",t),emptyStringOrWhitespace:t=>f(c.emptyStringOrWhitespace(t),"empty string or whitespace",t),nonEmptyString:t=>f(c.nonEmptyString(t),"non-empty string",t),nonEmptyStringAndNotWhitespace:t=>f(c.nonEmptyStringAndNotWhitespace(t),"non-empty string and not whitespace",t),emptyObject:t=>f(c.emptyObject(t),"empty object",t),nonEmptyObject:t=>f(c.nonEmptyObject(t),"non-empty object",t),emptySet:t=>f(c.emptySet(t),"empty set",t),nonEmptySet:t=>f(c.nonEmptySet(t),"non-empty set",t),emptyMap:t=>f(c.emptyMap(t),"empty map",t),nonEmptyMap:t=>f(c.nonEmptyMap(t),"non-empty map",t),propertyKey:t=>f(c.propertyKey(t),"PropertyKey",t),formData:t=>f(c.formData(t),"FormData",t),urlSearchParams:t=>f(c.urlSearchParams(t),"URLSearchParams",t),evenInteger:t=>f(c.evenInteger(t),"even integer",t),oddInteger:t=>f(c.oddInteger(t),"odd integer",t),directInstanceOf:(t,e)=>f(c.directInstanceOf(t,e),"T",t),inRange:(t,e)=>f(c.inRange(t,e),"in range",t),any:(t,...e)=>f(c.any(t,...e),"predicate returns truthy for any value",e,{multipleValues:!0}),all:(t,...e)=>f(c.all(t,...e),"predicate returns truthy for all values",e,{multipleValues:!0})};Object.defineProperties(c,{class:{value:c.class_},function:{value:c.function_},null:{value:c.null_}});Object.defineProperties(g,{class:{value:g.class_},function:{value:g.function_},null:{value:g.null_}});var d=c;var $i=require("node:events");var ar=class extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},qe=class t{static fn(e){return(...r)=>new t((n,s,i)=>{r.push(i),e(...r).then(n,s)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let s=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},i=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(s,i,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new ar(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(qe.prototype,Promise.prototype);function qo(t){return d.object(t)&&"_onResponse"in t}var v=class extends Error{constructor(e,r,n){if(super(e),Object.defineProperty(this,"input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Error.captureStackTrace(this,this.constructor),this.name="RequestError",this.code=r.code??"ERR_GOT_REQUEST_ERROR",this.input=r.input,qo(n)?(Object.defineProperty(this,"request",{enumerable:!1,value:n}),Object.defineProperty(this,"response",{enumerable:!1,value:n.response}),this.options=n.options):this.options=n,this.timings=this.request?.timings,d.string(r.stack)&&d.string(this.stack)){let s=this.stack.indexOf(this.message)+this.message.length,i=this.stack.slice(s).split(`
`).reverse(),o=r.stack.slice(r.stack.indexOf(r.message)+r.message.length).split(`
`).reverse();for(;o.length>0&&o[0]===i[0];)i.shift();this.stack=`${this.stack.slice(0,s)}${i.reverse().join(`
`)}${o.reverse().join(`
`)}`}}},xt=class extends v{constructor(e){super(`Redirected ${e.options.maxRedirects} times. Aborting.`,{},e),this.name="MaxRedirectsError",this.code="ERR_TOO_MANY_REDIRECTS"}},Oe=class extends v{constructor(e){super(`Response code ${e.statusCode} (${e.statusMessage})`,{},e.request),this.name="HTTPError",this.code="ERR_NON_2XX_3XX_RESPONSE"}},Ct=class extends v{constructor(e,r){super(e.message,e,r),this.name="CacheError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_CACHE_ACCESS":this.code}},Qe=class extends v{constructor(e,r){super(e.message,e,r),this.name="UploadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_UPLOAD":this.code}},Ot=class extends v{constructor(e,r,n){super(e.message,e,n),Object.defineProperty(this,"timings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.event=e.event,this.timings=r}},Je=class extends v{constructor(e,r){super(e.message,e,r),this.name="ReadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_READING_RESPONSE_STREAM":this.code}},Rt=class extends v{constructor(e){super("Retrying",{},e),this.name="RetryError",this.code="ERR_RETRYING"}},It=class extends v{constructor(e){super("This operation was aborted.",{},e),this.code="ERR_ABORTED",this.name="AbortError"}};var nn=D(require("node:process"),1),Kt=require("node:buffer"),qi=require("node:stream"),_t=D(require("node:http"),1);var zn=require("events"),Mn=require("util"),Fn=D($n(),1),jo=t=>{if(t.timings)return t.timings;let e={start:Date.now(),socket:void 0,lookup:void 0,connect:void 0,secureConnect:void 0,upload:void 0,response:void 0,end:void 0,error:void 0,abort:void 0,phases:{wait:void 0,dns:void 0,tcp:void 0,tls:void 0,request:void 0,firstByte:void 0,download:void 0,total:void 0}};t.timings=e;let r=o=>{o.once(zn.errorMonitor,()=>{e.error=Date.now(),e.phases.total=e.error-e.start})};r(t);let n=()=>{e.abort=Date.now(),e.phases.total=e.abort-e.start};t.prependOnceListener("abort",n);let s=o=>{if(e.socket=Date.now(),e.phases.wait=e.socket-e.start,Mn.types.isProxy(o))return;let a=()=>{e.lookup=Date.now(),e.phases.dns=e.lookup-e.socket};o.prependOnceListener("lookup",a),(0,Fn.default)(o,{connect:()=>{e.connect=Date.now(),e.lookup===void 0&&(o.removeListener("lookup",a),e.lookup=e.connect,e.phases.dns=e.lookup-e.socket),e.phases.tcp=e.connect-e.lookup},secureConnect:()=>{e.secureConnect=Date.now(),e.phases.tls=e.secureConnect-e.connect}})};t.socket?s(t.socket):t.prependOnceListener("socket",s);let i=()=>{e.upload=Date.now(),e.phases.request=e.upload-(e.secureConnect??e.connect)};return t.writableFinished?i():t.prependOnceListener("finish",i),t.prependOnceListener("response",o=>{e.response=Date.now(),e.phases.firstByte=e.response-e.upload,o.timings=e,r(o),o.prependOnceListener("end",()=>{t.off("abort",n),o.off("aborted",n),!e.phases.total&&(e.end=Date.now(),e.phases.download=e.end-e.response,e.phases.total=e.end-e.start)}),o.prependOnceListener("aborted",n)}),e},Vn=jo;var ns=D(require("node:events"),1),Ze=D(require("node:url"),1),ss=D(require("node:crypto"),1),kt=D(require("node:stream"),1);var $o="text/plain",zo="us-ascii",ur=(t,e)=>e.some(r=>r instanceof RegExp?r.test(t):r===t),Mo=new Set(["https:","http:","file:"]),Fo=t=>{try{let{protocol:e}=new URL(t);return e.endsWith(":")&&!e.includes(".")&&!Mo.has(e)}catch{return!1}},Vo=(t,{stripHash:e})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!r)throw new Error(`Invalid URL: ${t}`);let{type:n,data:s,hash:i}=r.groups,o=n.split(";");i=e?"":i;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let h=o.shift()?.toLowerCase()??"",b=[...o.map(x=>{let[y,p=""]=x.split("=").map(l=>l.trim());return y==="charset"&&(p=p.toLowerCase(),p===zo)?"":`${y}${p?`=${p}`:""}`}).filter(Boolean)];return a&&b.push("base64"),(b.length>0||h&&h!==$o)&&b.unshift(h),`data:${b.join(";")},${a?s.trim():s}${i?`#${i}`:""}`};function lr(t,e){if(e={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...e},typeof e.defaultProtocol=="string"&&!e.defaultProtocol.endsWith(":")&&(e.defaultProtocol=`${e.defaultProtocol}:`),t=t.trim(),/^data:/i.test(t))return Vo(t,e);if(Fo(t))return t;let r=t.startsWith("//");!r&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let s=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&s.protocol==="https:"&&(s.protocol="http:"),e.forceHttps&&s.protocol==="http:"&&(s.protocol="https:"),e.stripAuthentication&&(s.username="",s.password=""),e.stripHash?s.hash="":e.stripTextFragment&&(s.hash=s.hash.replace(/#?:~:text.*?$/i,"")),s.pathname){let o=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,h="";for(;;){let b=o.exec(s.pathname);if(!b)break;let x=b[0],y=b.index,p=s.pathname.slice(a,y);h+=p.replace(/\/{2,}/g,"/"),h+=x,a=y+x.length}let m=s.pathname.slice(a,s.pathname.length);h+=m.replace(/\/{2,}/g,"/"),s.pathname=h}if(s.pathname)try{s.pathname=decodeURI(s.pathname).replace(/\\/g,"%5C")}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let o=s.pathname.split("/"),a=o[o.length-1];ur(a,e.removeDirectoryIndex)&&(o=o.slice(0,-1),s.pathname=o.slice(1).join("/")+"/")}if(s.hostname&&(s.hostname=s.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(s.hostname)&&(s.hostname=s.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let o of[...s.searchParams.keys()])ur(o,e.removeQueryParameters)&&s.searchParams.delete(o);if(!Array.isArray(e.keepQueryParameters)&&e.removeQueryParameters===!0&&(s.search=""),Array.isArray(e.keepQueryParameters)&&e.keepQueryParameters.length>0)for(let o of[...s.searchParams.keys()])ur(o,e.keepQueryParameters)||s.searchParams.delete(o);if(e.sortQueryParameters){s.searchParams.sort();try{s.search=decodeURIComponent(s.search)}catch{}}e.removeTrailingSlash&&(s.pathname=s.pathname.replace(/\/$/,"")),e.removeExplicitPort&&s.port&&(s.port="");let i=t;return t=s.toString(),!e.removeSingleSlash&&s.pathname==="/"&&!i.endsWith("/")&&s.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||s.pathname==="/")&&s.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),r&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var is=D(pr(),1),At=D(Yn(),1);var Qn=require("node:stream");function Be(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e.toLowerCase(),r]))}var je=class extends Qn.Readable{statusCode;headers;body;url;constructor({statusCode:e,headers:r,body:n,url:s}){if(typeof e!="number")throw new TypeError("Argument `statusCode` should be a number");if(typeof r!="object")throw new TypeError("Argument `headers` should be an object");if(!(n instanceof Uint8Array))throw new TypeError("Argument `body` should be a buffer");if(typeof s!="string")throw new TypeError("Argument `url` should be a string");super({read(){this.push(n),this.push(null)}}),this.statusCode=e,this.headers=Be(r),this.body=n,this.url=s}};var et=D(ts(),1);var aa=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];function _r(t,e){if(e._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");let r=new Set([...Object.keys(t),...aa]),n={};for(let s of r)s in e||(n[s]={get(){let i=t[s];return typeof i=="function"?i.bind(t):i},set(i){t[s]=i},enumerable:!0,configurable:!1});return Object.defineProperties(e,n),t.once("aborted",()=>{e.destroy(),e.emit("aborted")}),t.once("close",()=>{t.complete&&e.readable?e.once("end",()=>{e.emit("close")}):e.emit("close")}),e}var Pt=class extends Error{constructor(e){super(e.message),Object.assign(this,e)}},Se=class extends Error{constructor(e){super(e.message),Object.assign(this,e)}};var br=class{constructor(e,r){this.hooks=new Map,this.request=()=>(n,s)=>{let i;if(typeof n=="string")i=wr(Ze.default.parse(n)),n={};else if(n instanceof Ze.default.URL)i=wr(Ze.default.parse(n.toString())),n={};else{let[y,...p]=(n.path??"").split("?"),l=p.length>0?`?${p.join("?")}`:"";i=wr({...n,pathname:y,search:l})}n={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...n,...ha(i)},n.headers=Object.fromEntries(ca(n.headers).map(([y,p])=>[y.toLowerCase(),p]));let o=new ns.default,a=lr(Ze.default.format(i),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),h=`${n.method}:${a}`;n.body&&n.method!==void 0&&["POST","PATCH","PUT"].includes(n.method)&&(n.body instanceof kt.default.Readable?n.cache=!1:h+=`:${ss.default.createHash("md5").update(n.body).digest("hex")}`);let m=!1,b=!1,x=y=>{b=!0;let p=!1,l=()=>{},u=new Promise(_=>{l=()=>{p||(p=!0,_())}}),S=async _=>{if(m){_.status=_.statusCode;let E=At.default.fromObject(m.cachePolicy).revalidatedPolicy(y,_);if(!E.modified){_.resume(),await new Promise(U=>{_.once("end",U)});let P=rs(E.policy.responseHeaders());_=new je({statusCode:m.statusCode,headers:P,body:m.body,url:m.url}),_.cachePolicy=E.policy,_.fromCache=!0}}_.fromCache||(_.cachePolicy=new At.default(y,_,y),_.fromCache=!1);let R;y.cache&&_.cachePolicy.storable()?(R=da(_),(async()=>{try{let E=is.default.buffer(_);await Promise.race([u,new Promise(xe=>_.once("end",xe)),new Promise(xe=>_.once("close",xe))]);let P=await E,U={url:_.url,statusCode:_.fromCache?m.statusCode:_.statusCode,body:P,cachePolicy:_.cachePolicy.toObject()},N=y.strictTtl?_.cachePolicy.timeToLive():void 0;if(y.maxTtl&&(N=N?Math.min(N,y.maxTtl):y.maxTtl),this.hooks.size>0)for(let xe of this.hooks.keys())U=await this.runHook(xe,U,_);await this.cache.set(h,U,N)}catch(E){o.emit("error",new Se(E))}})()):y.cache&&m&&(async()=>{try{await this.cache.delete(h)}catch(E){o.emit("error",new Se(E))}})(),o.emit("response",R??_),typeof s=="function"&&s(R??_)};try{let _=this.cacheRequest(y,S);_.once("error",l),_.once("abort",l),_.once("destroy",l),o.emit("request",_)}catch(_){o.emit("error",new Pt(_))}};return(async()=>{let y=async l=>{await Promise.resolve();let u=l.cache?await this.cache.get(h):void 0;if(u===void 0&&!l.forceRefresh){x(l);return}let S=At.default.fromObject(u.cachePolicy);if(S.satisfiesWithoutRevalidation(l)&&!l.forceRefresh){let _=rs(S.responseHeaders()),R=new je({statusCode:u.statusCode,headers:_,body:u.body,url:u.url});R.cachePolicy=S,R.fromCache=!0,o.emit("response",R),typeof s=="function"&&s(R)}else S.satisfiesWithoutRevalidation(l)&&Date.now()>=S.timeToLive()&&l.forceRefresh?(await this.cache.delete(h),l.headers=S.revalidationHeaders(l),x(l)):(m=u,l.headers=S.revalidationHeaders(l),x(l))},p=l=>o.emit("error",new Se(l));if(this.cache instanceof et.default){let l=this.cache;l.once("error",p),o.on("error",()=>l.removeListener("error",p)),o.on("response",()=>l.removeListener("error",p))}try{await y(n)}catch(l){n.automaticFailover&&!b&&x(n),o.emit("error",new Se(l))}})(),o},this.addHook=(n,s)=>{this.hooks.has(n)||this.hooks.set(n,s)},this.removeHook=n=>this.hooks.delete(n),this.getHook=n=>this.hooks.get(n),this.runHook=async(n,...s)=>this.hooks.get(n)?.(...s),r instanceof et.default?this.cache=r:typeof r=="string"?this.cache=new et.default({uri:r,namespace:"cacheable-request"}):this.cache=new et.default({store:r,namespace:"cacheable-request"}),this.request=this.request.bind(this),this.cacheRequest=e}},ca=Object.entries,da=t=>{let e=new kt.PassThrough({autoDestroy:!1});return _r(t,e),t.pipe(e)},ha=t=>{let e={...t};return e.path=`${t.pathname||"/"}${t.search||""}`,delete e.pathname,delete e.search,e},wr=t=>({protocol:t.protocol,auth:t.auth,hostname:t.hostname||t.host||"localhost",port:t.port,pathname:t.pathname,search:t.search}),rs=t=>{let e=[];for(let r of Object.keys(t))e[r.toLowerCase()]=t[r];return e},os=br;var Bi=D(hs(),1);var ji=D(pr(),1);var Q=t=>typeof t=="function";var ya=t=>Q(t[Symbol.asyncIterator]);async function*ga(t){let e=t.getReader();for(;;){let{done:r,value:n}=await e.read();if(r)break;yield n}}var us=t=>{if(ya(t))return t;if(Q(t.getReader))return ga(t);throw new TypeError("Unsupported data source: Expected either ReadableStream or async iterable.")};var ls="abcdefghijklmnopqrstuvwxyz0123456789";function ms(){let t=16,e="";for(;t--;)e+=ls[Math.random()*ls.length<<0];return e}var Sr=t=>String(t).replace(/\r|\n/g,(e,r,n)=>e==="\r"&&n[r+1]!==`
`||e===`
`&&n[r-1]!=="\r"?`\r
`:e);var fa=t=>Object.prototype.toString.call(t).slice(8,-1).toLowerCase();function xr(t){if(fa(t)!=="object")return!1;let e=Object.getPrototypeOf(t);return e==null?!0:(e.constructor&&e.constructor.toString())===Object.toString()}function ps(t,e){if(typeof e=="string"){for(let[r,n]of Object.entries(t))if(e.toLowerCase()===r.toLowerCase())return n}}var ys=t=>new Proxy(t,{get:(e,r)=>ps(e,r),has:(e,r)=>ps(e,r)!==void 0});var $e=t=>!!(t&&Q(t.constructor)&&t[Symbol.toStringTag]==="FormData"&&Q(t.append)&&Q(t.getAll)&&Q(t.entries)&&Q(t[Symbol.iterator]));var Cr=t=>String(t).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22");var Re=t=>!!(t&&typeof t=="object"&&Q(t.constructor)&&t[Symbol.toStringTag]==="File"&&Q(t.stream)&&t.name!=null);var tt=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},L=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},rt,Ie,nt,Ut,st,ke,it,ot,Lt,Or,gs,_a={enableAdditionalHeaders:!1},Nt={writable:!1,configurable:!1},vt=class{constructor(e,r,n){if(rt.add(this),Ie.set(this,`\r
`),nt.set(this,void 0),Ut.set(this,void 0),st.set(this,"-".repeat(2)),ke.set(this,new TextEncoder),it.set(this,void 0),ot.set(this,void 0),Lt.set(this,void 0),!$e(e))throw new TypeError("Expected first argument to be a FormData instance.");let s;if(xr(r)?n=r:s=r,s||(s=ms()),typeof s!="string")throw new TypeError("Expected boundary argument to be a string.");if(n&&!xr(n))throw new TypeError("Expected options argument to be an object.");tt(this,ot,Array.from(e.entries()),"f"),tt(this,Lt,{..._a,...n},"f"),tt(this,nt,L(this,ke,"f").encode(L(this,Ie,"f")),"f"),tt(this,Ut,L(this,nt,"f").byteLength,"f"),this.boundary=`form-data-boundary-${s}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,tt(this,it,L(this,ke,"f").encode(`${L(this,st,"f")}${this.boundary}${L(this,st,"f")}${L(this,Ie,"f").repeat(2)}`),"f");let i={"Content-Type":this.contentType},o=L(this,rt,"m",gs).call(this);o&&(this.contentLength=o,i["Content-Length"]=o),this.headers=ys(Object.freeze(i)),Object.defineProperties(this,{boundary:Nt,contentType:Nt,contentLength:Nt,headers:Nt})}getContentLength(){return this.contentLength==null?void 0:Number(this.contentLength)}*values(){for(let[e,r]of L(this,ot,"f")){let n=Re(r)?r:L(this,ke,"f").encode(Sr(r));yield L(this,rt,"m",Or).call(this,e,n),yield n,yield L(this,nt,"f")}yield L(this,it,"f")}async*encode(){for(let e of this.values())Re(e)?yield*us(e.stream()):yield e}[(Ie=new WeakMap,nt=new WeakMap,Ut=new WeakMap,st=new WeakMap,ke=new WeakMap,it=new WeakMap,ot=new WeakMap,Lt=new WeakMap,rt=new WeakSet,Or=function(r,n){let s="";s+=`${L(this,st,"f")}${this.boundary}${L(this,Ie,"f")}`,s+=`Content-Disposition: form-data; name="${Cr(r)}"`,Re(n)&&(s+=`; filename="${Cr(n.name)}"${L(this,Ie,"f")}`,s+=`Content-Type: ${n.type||"application/octet-stream"}`);let i=Re(n)?n.size:n.byteLength;return L(this,Lt,"f").enableAdditionalHeaders===!0&&i!=null&&!isNaN(i)&&(s+=`${L(this,Ie,"f")}Content-Length: ${Re(n)?n.size:n.byteLength}`),L(this,ke,"f").encode(`${s}${L(this,Ie,"f").repeat(2)}`)},gs=function(){let r=0;for(let[n,s]of L(this,ot,"f")){let i=Re(s)?s:L(this,ke,"f").encode(Sr(s)),o=Re(i)?i.size:i.byteLength;if(o==null||isNaN(o))return;r+=L(this,rt,"m",Or).call(this,n,i).byteLength,r+=o,r+=L(this,Ut,"f")}return String(r+L(this,it,"f").byteLength)},Symbol.iterator)](){return this.values()}[Symbol.asyncIterator](){return this.encode()}};var fs=require("node:buffer"),_s=require("node:util");function at(t){return d.nodeStream(t)&&d.function_(t.getBoundary)}async function Rr(t,e){if(e&&"content-length"in e)return Number(e["content-length"]);if(!t)return 0;if(d.string(t))return fs.Buffer.byteLength(t);if(d.buffer(t))return t.length;if(at(t))return(0,_s.promisify)(t.getLength.bind(t))()}function ct(t,e,r){let n={};for(let s of r){let i=(...o)=>{e.emit(s,...o)};n[s]=i,t.on(s,i)}return()=>{for(let[s,i]of Object.entries(n))t.off(s,i)}}var bs=D(require("node:net"),1);function Ir(){let t=[];return{once(e,r,n){e.once(r,n),t.push({origin:e,event:r,fn:n})},unhandleAll(){for(let e of t){let{origin:r,event:n,fn:s}=e;r.removeListener(n,s)}t.length=0}}}var ws=Symbol("reentry"),wa=()=>{},dt=class extends Error{constructor(e,r){super(`Timeout awaiting '${r}' for ${e}ms`),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.code="ETIMEDOUT"}};function Tr(t,e,r){if(ws in t)return wa;t[ws]=!0;let n=[],{once:s,unhandleAll:i}=Ir(),o=(u,S,_)=>{let R=setTimeout(S,u,u,_);R.unref?.();let E=()=>{clearTimeout(R)};return n.push(E),E},{host:a,hostname:h}=r,m=(u,S)=>{t.destroy(new dt(u,S))},b=()=>{for(let u of n)u();i()};if(t.once("error",u=>{if(b(),t.listenerCount("error")===0)throw u}),e.request!==void 0){let u=o(e.request,m,"request");s(t,"response",S=>{s(S,"end",u)})}if(e.socket!==void 0){let{socket:u}=e,S=()=>{m(u,"socket")};t.setTimeout(u,S),n.push(()=>{t.removeListener("timeout",S)})}let x=e.lookup!==void 0,y=e.connect!==void 0,p=e.secureConnect!==void 0,l=e.send!==void 0;return(x||y||p||l)&&s(t,"socket",u=>{let{socketPath:S}=t;if(u.connecting){let _=!!(S??bs.default.isIP(h??a??"")!==0);if(x&&!_&&u.address().address===void 0){let R=o(e.lookup,m,"lookup");s(u,"lookup",R)}if(y){let R=()=>o(e.connect,m,"connect");_?s(u,"connect",R()):s(u,"lookup",E=>{E===null&&s(u,"connect",R())})}p&&r.protocol==="https:"&&s(u,"connect",()=>{let R=o(e.secureConnect,m,"secureConnect");s(u,"secureConnect",R)})}if(l){let _=()=>o(e.send,m,"send");u.connecting?s(u,"connect",()=>{s(t,"upload-complete",_())}):s(t,"upload-complete",_())}}),e.response!==void 0&&s(t,"upload-complete",()=>{let u=o(e.response,m,"response");s(t,"response",u)}),e.read!==void 0&&s(t,"response",u=>{let S=o(e.read,m,"read");s(u,"end",S)}),b}function Pr(t){t=t;let e={protocol:t.protocol,hostname:d.string(t.hostname)&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,host:t.host,hash:t.hash,search:t.search,pathname:t.pathname,href:t.href,path:`${t.pathname||""}${t.search||""}`};return d.string(t.port)&&t.port.length>0&&(e.port=Number(t.port)),(t.username||t.password)&&(e.auth=`${t.username||""}:${t.password||""}`),e}var ht=class{constructor(){Object.defineProperty(this,"weakMap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"map",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.weakMap=new WeakMap,this.map=new Map}set(e,r){typeof e=="object"?this.weakMap.set(e,r):this.map.set(e,r)}get(e){return typeof e=="object"?this.weakMap.get(e):this.map.get(e)}has(e){return typeof e=="object"?this.weakMap.has(e):this.map.has(e)}};var ba=({attemptCount:t,retryOptions:e,error:r,retryAfter:n,computedValue:s})=>{if(r.name==="RetryError")return 1;if(t>e.limit)return 0;let i=e.methods.includes(r.options.method),o=e.errorCodes.includes(r.code),a=r.response&&e.statusCodes.includes(r.response.statusCode);if(!i||!o&&!a)return 0;if(r.response){if(n)return n>s?0:n;if(r.response.statusCode===413)return 0}let h=Math.random()*e.noise;return Math.min(2**(t-1)*1e3,e.backoffLimit)+h},Es=ba;var Ui=D(require("node:process"),1),ft=require("node:util"),Li=require("node:tls"),Ni=D(require("node:http"),1),vi=D(require("node:https"),1);var re=require("node:dns"),Ht=require("node:util"),Is=D(require("node:os"),1),{Resolver:Ss}=re.promises,ze=Symbol("cacheableLookupCreateConnection"),Ar=Symbol("cacheableLookupInstance"),xs=Symbol("expires"),Ea=typeof re.ALL=="number",Cs=t=>{if(!(t&&typeof t.createConnection=="function"))throw new Error("Expected an Agent instance as the first argument")},Sa=t=>{for(let e of t)e.family!==6&&(e.address=`::ffff:${e.address}`,e.family=6)},Os=()=>{let t=!1,e=!1;for(let r of Object.values(Is.default.networkInterfaces()))for(let n of r)if(!n.internal&&(n.family==="IPv6"?e=!0:t=!0,t&&e))return{has4:t,has6:e};return{has4:t,has6:e}},xa=t=>Symbol.iterator in t,Dt=t=>t.catch(e=>{if(e.code==="ENODATA"||e.code==="ENOTFOUND"||e.code==="ENOENT")return[];throw e}),Rs={ttl:!0},Ca={all:!0},Oa={all:!0,family:4},Ra={all:!0,family:6},ut=class{constructor({cache:e=new Map,maxTtl:r=1/0,fallbackDuration:n=3600,errorTtl:s=.15,resolver:i=new Ss,lookup:o=re.lookup}={}){if(this.maxTtl=r,this.errorTtl=s,this._cache=e,this._resolver=i,this._dnsLookup=o&&(0,Ht.promisify)(o),this.stats={cache:0,query:0},this._resolver instanceof Ss?(this._resolve4=this._resolver.resolve4.bind(this._resolver),this._resolve6=this._resolver.resolve6.bind(this._resolver)):(this._resolve4=(0,Ht.promisify)(this._resolver.resolve4.bind(this._resolver)),this._resolve6=(0,Ht.promisify)(this._resolver.resolve6.bind(this._resolver))),this._iface=Os(),this._pending={},this._nextRemovalTime=!1,this._hostnamesToFallback=new Set,this.fallbackDuration=n,n>0){let a=setInterval(()=>{this._hostnamesToFallback.clear()},n*1e3);a.unref&&a.unref(),this._fallbackInterval=a}this.lookup=this.lookup.bind(this),this.lookupAsync=this.lookupAsync.bind(this)}set servers(e){this.clear(),this._resolver.setServers(e)}get servers(){return this._resolver.getServers()}lookup(e,r,n){if(typeof r=="function"?(n=r,r={}):typeof r=="number"&&(r={family:r}),!n)throw new Error("Callback must be a function.");this.lookupAsync(e,r).then(s=>{r.all?n(null,s):n(null,s.address,s.family,s.expires,s.ttl,s.source)},n)}async lookupAsync(e,r={}){typeof r=="number"&&(r={family:r});let n=await this.query(e);if(r.family===6){let s=n.filter(i=>i.family===6);r.hints&re.V4MAPPED&&(Ea&&r.hints&re.ALL||s.length===0)?Sa(n):n=s}else r.family===4&&(n=n.filter(s=>s.family===4));if(r.hints&re.ADDRCONFIG){let{_iface:s}=this;n=n.filter(i=>i.family===6?s.has6:s.has4)}if(n.length===0){let s=new Error(`cacheableLookup ENOTFOUND ${e}`);throw s.code="ENOTFOUND",s.hostname=e,s}return r.all?n:n[0]}async query(e){let r="cache",n=await this._cache.get(e);if(n&&this.stats.cache++,!n){let s=this._pending[e];if(s)this.stats.cache++,n=await s;else{r="query";let i=this.queryAndCache(e);this._pending[e]=i,this.stats.query++;try{n=await i}finally{delete this._pending[e]}}}return n=n.map(s=>({...s,source:r})),n}async _resolve(e){let[r,n]=await Promise.all([Dt(this._resolve4(e,Rs)),Dt(this._resolve6(e,Rs))]),s=0,i=0,o=0,a=Date.now();for(let h of r)h.family=4,h.expires=a+h.ttl*1e3,s=Math.max(s,h.ttl);for(let h of n)h.family=6,h.expires=a+h.ttl*1e3,i=Math.max(i,h.ttl);return r.length>0?n.length>0?o=Math.min(s,i):o=s:o=i,{entries:[...r,...n],cacheTtl:o}}async _lookup(e){try{let[r,n]=await Promise.all([Dt(this._dnsLookup(e,Oa)),Dt(this._dnsLookup(e,Ra))]);return{entries:[...r,...n],cacheTtl:0}}catch{return{entries:[],cacheTtl:0}}}async _set(e,r,n){if(this.maxTtl>0&&n>0){n=Math.min(n,this.maxTtl)*1e3,r[xs]=Date.now()+n;try{await this._cache.set(e,r,n)}catch(s){this.lookupAsync=async()=>{let i=new Error("Cache Error. Please recreate the CacheableLookup instance.");throw i.cause=s,i}}xa(this._cache)&&this._tick(n)}}async queryAndCache(e){if(this._hostnamesToFallback.has(e))return this._dnsLookup(e,Ca);let r=await this._resolve(e);r.entries.length===0&&this._dnsLookup&&(r=await this._lookup(e),r.entries.length!==0&&this.fallbackDuration>0&&this._hostnamesToFallback.add(e));let n=r.entries.length===0?this.errorTtl:r.cacheTtl;return await this._set(e,r.entries,n),r.entries}_tick(e){let r=this._nextRemovalTime;(!r||e<r)&&(clearTimeout(this._removalTimeout),this._nextRemovalTime=e,this._removalTimeout=setTimeout(()=>{this._nextRemovalTime=!1;let n=1/0,s=Date.now();for(let[i,o]of this._cache){let a=o[xs];s>=a?this._cache.delete(i):a<n&&(n=a)}n!==1/0&&this._tick(n-s)},e),this._removalTimeout.unref&&this._removalTimeout.unref())}install(e){if(Cs(e),ze in e)throw new Error("CacheableLookup has been already installed");e[ze]=e.createConnection,e[Ar]=this,e.createConnection=(r,n)=>("lookup"in r||(r.lookup=this.lookup),e[ze](r,n))}uninstall(e){if(Cs(e),e[ze]){if(e[Ar]!==this)throw new Error("The agent is not owned by this CacheableLookup instance");e.createConnection=e[ze],delete e[ze],delete e[Ar]}}updateInterfaceInfo(){let{_iface:e}=this;this._iface=Os(),(e.has4&&!this._iface.has4||e.has6&&!this._iface.has6)&&this._cache.clear()}clear(e){if(e){this._cache.delete(e);return}this._cache.clear()}};var Di=D(Pi(),1);function en(t){let e=[],r=t.split(",");for(let n of r){let[s,...i]=n.split(";"),o=s.trim();if(o[0]!=="<"||o[o.length-1]!==">")throw new Error(`Invalid format of the Link header reference: ${o}`);let a=o.slice(1,-1),h={};if(i.length===0)throw new Error(`Unexpected end of Link header parameters: ${i.join(";")}`);for(let m of i){let b=m.trim(),x=b.indexOf("=");if(x===-1)throw new Error(`Failed to parse Link header: ${t}`);let y=b.slice(0,x).trim(),p=b.slice(x+1).trim();h[y]=p}e.push({reference:a,parameters:h})}return e}var[Ai,Kc]=Ui.default.versions.node.split(".").map(Number);function Yc(t){for(let e in t){let r=t[e];g.any([d.string,d.number,d.boolean,d.null_,d.undefined],r)}}var Qc=new Map,Ft,Jc=()=>Ft||(Ft=new ut,Ft),Xc={request:void 0,agent:{http:void 0,https:void 0,http2:void 0},h2session:void 0,decompress:!0,timeout:{connect:void 0,lookup:void 0,read:void 0,request:void 0,response:void 0,secureConnect:void 0,send:void 0,socket:void 0},prefixUrl:"",body:void 0,form:void 0,json:void 0,cookieJar:void 0,ignoreInvalidCookies:!1,searchParams:void 0,dnsLookup:void 0,dnsCache:void 0,context:{},hooks:{init:[],beforeRequest:[],beforeError:[],beforeRedirect:[],beforeRetry:[],afterResponse:[]},followRedirect:!0,maxRedirects:10,cache:void 0,throwHttpErrors:!0,username:"",password:"",http2:!1,allowGetBody:!1,headers:{"user-agent":"got (https://github.com/sindresorhus/got)"},methodRewriting:!1,dnsLookupIpVersion:void 0,parseJson:JSON.parse,stringifyJson:JSON.stringify,retry:{limit:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504,521,522,524],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"],maxRetryAfter:void 0,calculateDelay:({computedValue:t})=>t,backoffLimit:Number.POSITIVE_INFINITY,noise:100},localAddress:void 0,method:"GET",createConnection:void 0,cacheOptions:{shared:void 0,cacheHeuristic:void 0,immutableMinTimeToLive:void 0,ignoreCargoCult:void 0},https:{alpnProtocols:void 0,rejectUnauthorized:void 0,checkServerIdentity:void 0,certificateAuthority:void 0,key:void 0,certificate:void 0,passphrase:void 0,pfx:void 0,ciphers:void 0,honorCipherOrder:void 0,minVersion:void 0,maxVersion:void 0,signatureAlgorithms:void 0,tlsSessionLifetime:void 0,dhparam:void 0,ecdhCurve:void 0,certificateRevocationLists:void 0},encoding:void 0,resolveBodyOnly:!1,isStream:!1,responseType:"text",url:void 0,pagination:{transform(t){return t.request.options.responseType==="json"?t.body:JSON.parse(t.body)},paginate({response:t}){let e=t.headers.link;if(typeof e!="string"||e.trim()==="")return!1;let n=en(e).find(s=>s.parameters.rel==="next"||s.parameters.rel==='"next"');return n?{url:new URL(n.reference,t.url)}:!1},filter:()=>!0,shouldContinue:()=>!0,countLimit:Number.POSITIVE_INFINITY,backoff:0,requestLimit:1e4,stackAllItems:!1},setHost:!0,maxHeaderSize:void 0,signal:void 0,enableUnixSockets:!1},Zc=t=>{let{hooks:e,retry:r}=t,n={...t,context:{...t.context},cacheOptions:{...t.cacheOptions},https:{...t.https},agent:{...t.agent},headers:{...t.headers},retry:{...r,errorCodes:[...r.errorCodes],methods:[...r.methods],statusCodes:[...r.statusCodes]},timeout:{...t.timeout},hooks:{init:[...e.init],beforeRequest:[...e.beforeRequest],beforeError:[...e.beforeError],beforeRedirect:[...e.beforeRedirect],beforeRetry:[...e.beforeRetry],afterResponse:[...e.afterResponse]},searchParams:t.searchParams?new URLSearchParams(t.searchParams):void 0,pagination:{...t.pagination}};return n.url!==void 0&&(n.prefixUrl=""),n},ed=t=>{let{hooks:e,retry:r}=t,n={...t};return d.object(t.context)&&(n.context={...t.context}),d.object(t.cacheOptions)&&(n.cacheOptions={...t.cacheOptions}),d.object(t.https)&&(n.https={...t.https}),d.object(t.cacheOptions)&&(n.cacheOptions={...n.cacheOptions}),d.object(t.agent)&&(n.agent={...t.agent}),d.object(t.headers)&&(n.headers={...t.headers}),d.object(r)&&(n.retry={...r},d.array(r.errorCodes)&&(n.retry.errorCodes=[...r.errorCodes]),d.array(r.methods)&&(n.retry.methods=[...r.methods]),d.array(r.statusCodes)&&(n.retry.statusCodes=[...r.statusCodes])),d.object(t.timeout)&&(n.timeout={...t.timeout}),d.object(e)&&(n.hooks={...e},d.array(e.init)&&(n.hooks.init=[...e.init]),d.array(e.beforeRequest)&&(n.hooks.beforeRequest=[...e.beforeRequest]),d.array(e.beforeError)&&(n.hooks.beforeError=[...e.beforeError]),d.array(e.beforeRedirect)&&(n.hooks.beforeRedirect=[...e.beforeRedirect]),d.array(e.beforeRetry)&&(n.hooks.beforeRetry=[...e.beforeRetry]),d.array(e.afterResponse)&&(n.hooks.afterResponse=[...e.afterResponse])),d.object(t.pagination)&&(n.pagination={...t.pagination}),n},td=t=>{let e=[t.timeout.socket,t.timeout.connect,t.timeout.lookup,t.timeout.request,t.timeout.secureConnect].filter(r=>typeof r=="number");if(e.length>0)return Math.min(...e)},ki=(t,e,r)=>{let n=t.hooks?.init;if(n)for(let s of n)s(e,r)},J=class t{constructor(e,r,n){if(Object.defineProperty(this,"_unixOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_internals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_merging",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_init",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),g.any([d.string,d.urlInstance,d.object,d.undefined],e),g.any([d.object,d.undefined],r),g.any([d.object,d.undefined],n),e instanceof t||r instanceof t)throw new TypeError("The defaults must be passed as the third argument");this._internals=Zc(n?._internals??n??Xc),this._init=[...n?._init??[]],this._merging=!1,this._unixOptions=void 0;try{if(d.plainObject(e))try{this.merge(e),this.merge(r)}finally{this.url=e.url}else try{this.merge(r)}finally{if(r?.url!==void 0)if(e===void 0)this.url=r.url;else throw new TypeError("The `url` option is mutually exclusive with the `input` argument");else e!==void 0&&(this.url=e)}}catch(s){throw s.options=this,s}}merge(e){if(e){if(e instanceof t){for(let r of e._init)this.merge(r);return}e=ed(e),ki(this,e,this),ki(e,e,this),this._merging=!0,"isStream"in e&&(this.isStream=e.isStream);try{let r=!1;for(let n in e){if(n==="mutableDefaults"||n==="handlers"||n==="url")continue;if(!(n in this))throw new Error(`Unexpected option: ${n}`);let s=e[n];s!==void 0&&(this[n]=s,r=!0)}r&&this._init.push(e)}finally{this._merging=!1}}}get request(){return this._internals.request}set request(e){g.any([d.function_,d.undefined],e),this._internals.request=e}get agent(){return this._internals.agent}set agent(e){g.plainObject(e);for(let r in e){if(!(r in this._internals.agent))throw new TypeError(`Unexpected agent option: ${r}`);g.any([d.object,d.undefined],e[r])}this._merging?Object.assign(this._internals.agent,e):this._internals.agent={...e}}get h2session(){return this._internals.h2session}set h2session(e){this._internals.h2session=e}get decompress(){return this._internals.decompress}set decompress(e){g.boolean(e),this._internals.decompress=e}get timeout(){return this._internals.timeout}set timeout(e){g.plainObject(e);for(let r in e){if(!(r in this._internals.timeout))throw new Error(`Unexpected timeout option: ${r}`);g.any([d.number,d.undefined],e[r])}this._merging?Object.assign(this._internals.timeout,e):this._internals.timeout={...e}}get prefixUrl(){return this._internals.prefixUrl}set prefixUrl(e){if(g.any([d.string,d.urlInstance],e),e===""){this._internals.prefixUrl="";return}if(e=e.toString(),e.endsWith("/")||(e+="/"),this._internals.prefixUrl&&this._internals.url){let{href:r}=this._internals.url;this._internals.url.href=e+r.slice(this._internals.prefixUrl.length)}this._internals.prefixUrl=e}get body(){return this._internals.body}set body(e){g.any([d.string,d.buffer,d.nodeStream,d.generator,d.asyncGenerator,$e,d.undefined],e),d.nodeStream(e)&&g.truthy(e.readable),e!==void 0&&(g.undefined(this._internals.form),g.undefined(this._internals.json)),this._internals.body=e}get form(){return this._internals.form}set form(e){g.any([d.plainObject,d.undefined],e),e!==void 0&&(g.undefined(this._internals.body),g.undefined(this._internals.json)),this._internals.form=e}get json(){return this._internals.json}set json(e){e!==void 0&&(g.undefined(this._internals.body),g.undefined(this._internals.form)),this._internals.json=e}get url(){return this._internals.url}set url(e){if(g.any([d.string,d.urlInstance,d.undefined],e),e===void 0){this._internals.url=void 0;return}if(d.string(e)&&e.startsWith("/"))throw new Error("`url` must not start with a slash");let r=`${this.prefixUrl}${e.toString()}`,n=new URL(r);if(this._internals.url=n,n.protocol==="unix:"&&(n.href=`http://unix${n.pathname}${n.search}`),n.protocol!=="http:"&&n.protocol!=="https:"){let s=new Error(`Unsupported protocol: ${n.protocol}`);throw s.code="ERR_UNSUPPORTED_PROTOCOL",s}if(this._internals.username&&(n.username=this._internals.username,this._internals.username=""),this._internals.password&&(n.password=this._internals.password,this._internals.password=""),this._internals.searchParams&&(n.search=this._internals.searchParams.toString(),this._internals.searchParams=void 0),n.hostname==="unix"){if(!this._internals.enableUnixSockets)throw new Error("Using UNIX domain sockets but option `enableUnixSockets` is not enabled");let s=/(?<socketPath>.+?):(?<path>.+)/.exec(`${n.pathname}${n.search}`);if(s?.groups){let{socketPath:i,path:o}=s.groups;this._unixOptions={socketPath:i,path:o,host:""}}else this._unixOptions=void 0;return}this._unixOptions=void 0}get cookieJar(){return this._internals.cookieJar}set cookieJar(e){if(g.any([d.object,d.undefined],e),e===void 0){this._internals.cookieJar=void 0;return}let{setCookie:r,getCookieString:n}=e;g.function_(r),g.function_(n),r.length===4&&n.length===0?(r=(0,ft.promisify)(r.bind(e)),n=(0,ft.promisify)(n.bind(e)),this._internals.cookieJar={setCookie:r,getCookieString:n}):this._internals.cookieJar=e}get signal(){return this._internals.signal}set signal(e){g.object(e),this._internals.signal=e}get ignoreInvalidCookies(){return this._internals.ignoreInvalidCookies}set ignoreInvalidCookies(e){g.boolean(e),this._internals.ignoreInvalidCookies=e}get searchParams(){return this._internals.url?this._internals.url.searchParams:(this._internals.searchParams===void 0&&(this._internals.searchParams=new URLSearchParams),this._internals.searchParams)}set searchParams(e){g.any([d.string,d.object,d.undefined],e);let r=this._internals.url;if(e===void 0){this._internals.searchParams=void 0,r&&(r.search="");return}let n=this.searchParams,s;if(d.string(e))s=new URLSearchParams(e);else if(e instanceof URLSearchParams)s=e;else{Yc(e),s=new URLSearchParams;for(let i in e){let o=e[i];o===null?s.append(i,""):o===void 0?n.delete(i):s.append(i,o)}}if(this._merging){for(let i of s.keys())n.delete(i);for(let[i,o]of s)n.append(i,o)}else r?r.search=n.toString():this._internals.searchParams=n}get searchParameters(){throw new Error("The `searchParameters` option does not exist. Use `searchParams` instead.")}set searchParameters(e){throw new Error("The `searchParameters` option does not exist. Use `searchParams` instead.")}get dnsLookup(){return this._internals.dnsLookup}set dnsLookup(e){g.any([d.function_,d.undefined],e),this._internals.dnsLookup=e}get dnsCache(){return this._internals.dnsCache}set dnsCache(e){g.any([d.object,d.boolean,d.undefined],e),e===!0?this._internals.dnsCache=Jc():e===!1?this._internals.dnsCache=void 0:this._internals.dnsCache=e}get context(){return this._internals.context}set context(e){g.object(e),this._merging?Object.assign(this._internals.context,e):this._internals.context={...e}}get hooks(){return this._internals.hooks}set hooks(e){g.object(e);for(let r in e){if(!(r in this._internals.hooks))throw new Error(`Unexpected hook event: ${r}`);let n=r,s=e[n];if(g.any([d.array,d.undefined],s),s)for(let i of s)g.function_(i);if(this._merging)s&&this._internals.hooks[n].push(...s);else{if(!s)throw new Error(`Missing hook event: ${r}`);this._internals.hooks[r]=[...s]}}}get followRedirect(){return this._internals.followRedirect}set followRedirect(e){g.boolean(e),this._internals.followRedirect=e}get followRedirects(){throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.")}set followRedirects(e){throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.")}get maxRedirects(){return this._internals.maxRedirects}set maxRedirects(e){g.number(e),this._internals.maxRedirects=e}get cache(){return this._internals.cache}set cache(e){g.any([d.object,d.string,d.boolean,d.undefined],e),e===!0?this._internals.cache=Qc:e===!1?this._internals.cache=void 0:this._internals.cache=e}get throwHttpErrors(){return this._internals.throwHttpErrors}set throwHttpErrors(e){g.boolean(e),this._internals.throwHttpErrors=e}get username(){let e=this._internals.url,r=e?e.username:this._internals.username;return decodeURIComponent(r)}set username(e){g.string(e);let r=this._internals.url,n=encodeURIComponent(e);r?r.username=n:this._internals.username=n}get password(){let e=this._internals.url,r=e?e.password:this._internals.password;return decodeURIComponent(r)}set password(e){g.string(e);let r=this._internals.url,n=encodeURIComponent(e);r?r.password=n:this._internals.password=n}get http2(){return this._internals.http2}set http2(e){g.boolean(e),this._internals.http2=e}get allowGetBody(){return this._internals.allowGetBody}set allowGetBody(e){g.boolean(e),this._internals.allowGetBody=e}get headers(){return this._internals.headers}set headers(e){g.plainObject(e),this._merging?Object.assign(this._internals.headers,Be(e)):this._internals.headers=Be(e)}get methodRewriting(){return this._internals.methodRewriting}set methodRewriting(e){g.boolean(e),this._internals.methodRewriting=e}get dnsLookupIpVersion(){return this._internals.dnsLookupIpVersion}set dnsLookupIpVersion(e){if(e!==void 0&&e!==4&&e!==6)throw new TypeError(`Invalid DNS lookup IP version: ${e}`);this._internals.dnsLookupIpVersion=e}get parseJson(){return this._internals.parseJson}set parseJson(e){g.function_(e),this._internals.parseJson=e}get stringifyJson(){return this._internals.stringifyJson}set stringifyJson(e){g.function_(e),this._internals.stringifyJson=e}get retry(){return this._internals.retry}set retry(e){if(g.plainObject(e),g.any([d.function_,d.undefined],e.calculateDelay),g.any([d.number,d.undefined],e.maxRetryAfter),g.any([d.number,d.undefined],e.limit),g.any([d.array,d.undefined],e.methods),g.any([d.array,d.undefined],e.statusCodes),g.any([d.array,d.undefined],e.errorCodes),g.any([d.number,d.undefined],e.noise),e.noise&&Math.abs(e.noise)>100)throw new Error(`The maximum acceptable retry noise is +/- 100ms, got ${e.noise}`);for(let n in e)if(!(n in this._internals.retry))throw new Error(`Unexpected retry option: ${n}`);this._merging?Object.assign(this._internals.retry,e):this._internals.retry={...e};let{retry:r}=this._internals;r.methods=[...new Set(r.methods.map(n=>n.toUpperCase()))],r.statusCodes=[...new Set(r.statusCodes)],r.errorCodes=[...new Set(r.errorCodes)]}get localAddress(){return this._internals.localAddress}set localAddress(e){g.any([d.string,d.undefined],e),this._internals.localAddress=e}get method(){return this._internals.method}set method(e){g.string(e),this._internals.method=e.toUpperCase()}get createConnection(){return this._internals.createConnection}set createConnection(e){g.any([d.function_,d.undefined],e),this._internals.createConnection=e}get cacheOptions(){return this._internals.cacheOptions}set cacheOptions(e){g.plainObject(e),g.any([d.boolean,d.undefined],e.shared),g.any([d.number,d.undefined],e.cacheHeuristic),g.any([d.number,d.undefined],e.immutableMinTimeToLive),g.any([d.boolean,d.undefined],e.ignoreCargoCult);for(let r in e)if(!(r in this._internals.cacheOptions))throw new Error(`Cache option \`${r}\` does not exist`);this._merging?Object.assign(this._internals.cacheOptions,e):this._internals.cacheOptions={...e}}get https(){return this._internals.https}set https(e){g.plainObject(e),g.any([d.boolean,d.undefined],e.rejectUnauthorized),g.any([d.function_,d.undefined],e.checkServerIdentity),g.any([d.string,d.object,d.array,d.undefined],e.certificateAuthority),g.any([d.string,d.object,d.array,d.undefined],e.key),g.any([d.string,d.object,d.array,d.undefined],e.certificate),g.any([d.string,d.undefined],e.passphrase),g.any([d.string,d.buffer,d.array,d.undefined],e.pfx),g.any([d.array,d.undefined],e.alpnProtocols),g.any([d.string,d.undefined],e.ciphers),g.any([d.string,d.buffer,d.undefined],e.dhparam),g.any([d.string,d.undefined],e.signatureAlgorithms),g.any([d.string,d.undefined],e.minVersion),g.any([d.string,d.undefined],e.maxVersion),g.any([d.boolean,d.undefined],e.honorCipherOrder),g.any([d.number,d.undefined],e.tlsSessionLifetime),g.any([d.string,d.undefined],e.ecdhCurve),g.any([d.string,d.buffer,d.array,d.undefined],e.certificateRevocationLists);for(let r in e)if(!(r in this._internals.https))throw new Error(`HTTPS option \`${r}\` does not exist`);this._merging?Object.assign(this._internals.https,e):this._internals.https={...e}}get encoding(){return this._internals.encoding}set encoding(e){if(e===null)throw new TypeError("To get a Buffer, set `options.responseType` to `buffer` instead");g.any([d.string,d.undefined],e),this._internals.encoding=e}get resolveBodyOnly(){return this._internals.resolveBodyOnly}set resolveBodyOnly(e){g.boolean(e),this._internals.resolveBodyOnly=e}get isStream(){return this._internals.isStream}set isStream(e){g.boolean(e),this._internals.isStream=e}get responseType(){return this._internals.responseType}set responseType(e){if(e===void 0){this._internals.responseType="text";return}if(e!=="text"&&e!=="buffer"&&e!=="json")throw new Error(`Invalid \`responseType\` option: ${e}`);this._internals.responseType=e}get pagination(){return this._internals.pagination}set pagination(e){g.object(e),this._merging?Object.assign(this._internals.pagination,e):this._internals.pagination=e}get auth(){throw new Error("Parameter `auth` is deprecated. Use `username` / `password` instead.")}set auth(e){throw new Error("Parameter `auth` is deprecated. Use `username` / `password` instead.")}get setHost(){return this._internals.setHost}set setHost(e){g.boolean(e),this._internals.setHost=e}get maxHeaderSize(){return this._internals.maxHeaderSize}set maxHeaderSize(e){g.any([d.number,d.undefined],e),this._internals.maxHeaderSize=e}get enableUnixSockets(){return this._internals.enableUnixSockets}set enableUnixSockets(e){g.boolean(e),this._internals.enableUnixSockets=e}toJSON(){return{...this._internals}}[Symbol.for("nodejs.util.inspect.custom")](e,r){return(0,ft.inspect)(this._internals,r)}createNativeRequestOptions(){let e=this._internals,r=e.url,n;r.protocol==="https:"?n=e.http2?e.agent:e.agent.https:n=e.agent.http;let{https:s}=e,{pfx:i}=s;return d.array(i)&&d.plainObject(i[0])&&(i=i.map(o=>({buf:o.buffer,passphrase:o.passphrase}))),{...e.cacheOptions,...this._unixOptions,ALPNProtocols:s.alpnProtocols,ca:s.certificateAuthority,cert:s.certificate,key:s.key,passphrase:s.passphrase,pfx:s.pfx,rejectUnauthorized:s.rejectUnauthorized,checkServerIdentity:s.checkServerIdentity??Li.checkServerIdentity,ciphers:s.ciphers,honorCipherOrder:s.honorCipherOrder,minVersion:s.minVersion,maxVersion:s.maxVersion,sigalgs:s.signatureAlgorithms,sessionTimeout:s.tlsSessionLifetime,dhparam:s.dhparam,ecdhCurve:s.ecdhCurve,crl:s.certificateRevocationLists,lookup:e.dnsLookup??e.dnsCache?.lookup,family:e.dnsLookupIpVersion,agent:n,setHost:e.setHost,method:e.method,maxHeaderSize:e.maxHeaderSize,localAddress:e.localAddress,headers:e.headers,createConnection:e.createConnection,timeout:e.http2?td(e):void 0,h2session:e.h2session}}getRequestFunction(){let e=this._internals.url,{request:r}=this._internals;return!r&&e?this.getFallbackRequestFunction():r}getFallbackRequestFunction(){let e=this._internals.url;if(e){if(e.protocol==="https:"){if(this._internals.http2){if(Ai<15||Ai===15&&Kc<10){let r=new Error("To use the `http2` option, install Node.js 15.10.0 or above");throw r.code="EUNSUPPORTED",r}return Di.default.auto}return vi.default.request}return Ni.default.request}}freeze(){let e=this._internals;Object.freeze(e),Object.freeze(e.hooks),Object.freeze(e.hooks.afterResponse),Object.freeze(e.hooks.beforeError),Object.freeze(e.hooks.beforeRedirect),Object.freeze(e.hooks.beforeRequest),Object.freeze(e.hooks.beforeRetry),Object.freeze(e.hooks.init),Object.freeze(e.https),Object.freeze(e.cacheOptions),Object.freeze(e.agent),Object.freeze(e.headers),Object.freeze(e.timeout),Object.freeze(e.retry),Object.freeze(e.retry.errorCodes),Object.freeze(e.retry.methods),Object.freeze(e.retry.statusCodes)}};var Ge=t=>{let{statusCode:e}=t,r=t.request.options.followRedirect?299:399;return e>=200&&e<=r||e===304},Vt=class extends v{constructor(e,r){let{options:n}=r.request;super(`${e.message} in "${n.url.toString()}"`,e,r.request),this.name="ParseError",this.code="ERR_BODY_PARSE_FAILURE"}},tn=(t,e,r,n)=>{let{rawBody:s}=t;try{if(e==="text")return s.toString(n);if(e==="json")return s.length===0?"":r(s.toString(n));if(e==="buffer")return s}catch(i){throw new Vt(i,t)}throw new Vt({message:`Unknown body type '${e}'`,name:"Error"},t)};function rd(t){return t.writable&&!t.writableEnded}var Hi=rd;function Gt(t){return t.protocol==="unix:"||t.hostname==="unix"}var{buffer:nd}=ji.default,sd=d.string(nn.default.versions.brotli),id=new Set(["GET","HEAD"]),rn=new ht,od=new Set([300,301,302,303,304,307,308]),ad=["socket","connect","continue","information","upgrade"],Wt=()=>{},Ne=class t extends qi.Duplex{constructor(e,r,n){super({autoDestroy:!1,highWaterMark:0}),Object.defineProperty(this,"constructor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_noPipe",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"redirectUrls",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_stopRetry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downloadedSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_uploadedSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_stopReading",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pipedServerResponses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_responseSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bodySize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_unproxyEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isFromCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cannotHaveBody",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_triggerRead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cancelTimeouts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_removeListeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nativeResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_flushed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_aborted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_requestInitialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._downloadedSize=0,this._uploadedSize=0,this._stopReading=!1,this._pipedServerResponses=new Set,this._cannotHaveBody=!1,this._unproxyEvents=Wt,this._triggerRead=!1,this._cancelTimeouts=Wt,this._removeListeners=Wt,this._jobs=[],this._flushed=!1,this._requestInitialized=!1,this._aborted=!1,this.redirectUrls=[],this.retryCount=0,this._stopRetry=Wt,this.on("pipe",i=>{i?.headers&&Object.assign(this.options.headers,i.headers)}),this.on("newListener",i=>{if(i==="retry"&&this.listenerCount("retry")>0)throw new Error("A retry listener has been attached already.")});try{if(this.options=new J(e,r,n),!this.options.url){if(this.options.prefixUrl==="")throw new TypeError("Missing `url` property");this.options.url=""}this.requestUrl=this.options.url}catch(i){let{options:o}=i;o&&(this.options=o),this.flush=async()=>{this.flush=async()=>{},this.destroy(i)};return}let{body:s}=this.options;if(d.nodeStream(s)&&s.once("error",i=>{this._flushed?this._beforeError(new Qe(i,this)):this.flush=async()=>{this.flush=async()=>{},this._beforeError(new Qe(i,this))}}),this.options.signal){let i=()=>{this.destroy(new It(this))};this.options.signal.aborted?i():(this.options.signal.addEventListener("abort",i),this._removeListeners=()=>{this.options.signal?.removeEventListener("abort",i)})}}async flush(){if(!this._flushed){this._flushed=!0;try{if(await this._finalizeBody(),this.destroyed)return;if(await this._makeRequest(),this.destroyed){this._request?.destroy();return}for(let e of this._jobs)e();this._jobs.length=0,this._requestInitialized=!0}catch(e){this._beforeError(e)}}}_beforeError(e){if(this._stopReading)return;let{response:r,options:n}=this,s=this.retryCount+(e.name==="RetryError"?0:1);this._stopReading=!0,e instanceof v||(e=new v(e.message,e,this));let i=e;(async()=>{if(r?.readable&&!r.rawBody&&!this._request?.socket?.destroyed&&(r.setEncoding(this.readableEncoding),await this._setRawBody(r)&&(r.body=r.rawBody.toString())),this.listenerCount("retry")!==0){let o;try{let a;r&&"retry-after"in r.headers&&(a=Number(r.headers["retry-after"]),Number.isNaN(a)?(a=Date.parse(r.headers["retry-after"])-Date.now(),a<=0&&(a=1)):a*=1e3);let h=n.retry;o=await h.calculateDelay({attemptCount:s,retryOptions:h,error:i,retryAfter:a,computedValue:Es({attemptCount:s,retryOptions:h,error:i,retryAfter:a,computedValue:h.maxRetryAfter??n.timeout.request??Number.POSITIVE_INFINITY})})}catch(a){this._error(new v(a.message,a,this));return}if(o){if(await new Promise(a=>{let h=setTimeout(a,o);this._stopRetry=()=>{clearTimeout(h),a()}}),this.destroyed)return;try{for(let a of this.options.hooks.beforeRetry)await a(i,this.retryCount+1)}catch(a){this._error(new v(a.message,e,this));return}if(this.destroyed)return;this.destroy(),this.emit("retry",this.retryCount+1,e,a=>{let h=new t(n.url,a,n);return h.retryCount=this.retryCount+1,nn.default.nextTick(()=>{h.flush()}),h});return}}this._error(i)})()}_read(){this._triggerRead=!0;let{response:e}=this;if(e&&!this._stopReading){e.readableLength&&(this._triggerRead=!1);let r;for(;(r=e.read())!==null;){this._downloadedSize+=r.length;let n=this.downloadProgress;n.percent<1&&this.emit("downloadProgress",n),this.push(r)}}}_write(e,r,n){let s=()=>{this._writeRequest(e,r,n)};this._requestInitialized?s():this._jobs.push(s)}_final(e){let r=()=>{if(!this._request||this._request.destroyed){e();return}this._request.end(n=>{this._request._writableState?.errored||(n||(this._bodySize=this._uploadedSize,this.emit("uploadProgress",this.uploadProgress),this._request.emit("upload-complete")),e(n))})};this._requestInitialized?r():this._jobs.push(r)}_destroy(e,r){if(this._stopReading=!0,this.flush=async()=>{},this._stopRetry(),this._cancelTimeouts(),this._removeListeners(),this.options){let{body:n}=this.options;d.nodeStream(n)&&n.destroy()}this._request&&this._request.destroy(),e!==null&&!d.undefined(e)&&!(e instanceof v)&&(e=new v(e.message,e,this)),r(e)}pipe(e,r){return e instanceof _t.ServerResponse&&this._pipedServerResponses.add(e),super.pipe(e,r)}unpipe(e){return e instanceof _t.ServerResponse&&this._pipedServerResponses.delete(e),super.unpipe(e),this}async _finalizeBody(){let{options:e}=this,{headers:r}=e,n=!d.undefined(e.form),s=!d.undefined(e.json),i=!d.undefined(e.body),o=id.has(e.method)&&!(e.method==="GET"&&e.allowGetBody);if(this._cannotHaveBody=o,n||s||i){if(o)throw new TypeError(`The \`${e.method}\` method cannot be used with a body`);let a=!d.string(r["content-type"]);if(i){if($e(e.body)){let m=new vt(e.body);a&&(r["content-type"]=m.headers["Content-Type"]),"Content-Length"in m.headers&&(r["content-length"]=m.headers["Content-Length"]),e.body=m.encode()}at(e.body)&&a&&(r["content-type"]=`multipart/form-data; boundary=${e.body.getBoundary()}`)}else if(n){a&&(r["content-type"]="application/x-www-form-urlencoded");let{form:m}=e;e.form=void 0,e.body=new URLSearchParams(m).toString()}else{a&&(r["content-type"]="application/json");let{json:m}=e;e.json=void 0,e.body=e.stringifyJson(m)}let h=await Rr(e.body,e.headers);d.undefined(r["content-length"])&&d.undefined(r["transfer-encoding"])&&!o&&!d.undefined(h)&&(r["content-length"]=String(h))}e.responseType==="json"&&!("accept"in e.headers)&&(e.headers.accept="application/json"),this._bodySize=Number(r["content-length"])||void 0}async _onResponseBase(e){if(this.isAborted)return;let{options:r}=this,{url:n}=r;this._nativeResponse=e,r.decompress&&(e=(0,Bi.default)(e));let s=e.statusCode,i=e;i.statusMessage=i.statusMessage??_t.default.STATUS_CODES[s],i.url=r.url.toString(),i.requestUrl=this.requestUrl,i.redirectUrls=this.redirectUrls,i.request=this,i.isFromCache=this._nativeResponse.fromCache??!1,i.ip=this.ip,i.retryCount=this.retryCount,i.ok=Ge(i),this._isFromCache=i.isFromCache,this._responseSize=Number(e.headers["content-length"])||void 0,this.response=i,e.once("end",()=>{this._responseSize=this._downloadedSize,this.emit("downloadProgress",this.downloadProgress)}),e.once("error",a=>{this._aborted=!0,e.destroy(),this._beforeError(new Je(a,this))}),e.once("aborted",()=>{this._aborted=!0,this._beforeError(new Je({name:"Error",message:"The server aborted pending request",code:"ECONNRESET"},this))}),this.emit("downloadProgress",this.downloadProgress);let o=e.headers["set-cookie"];if(d.object(r.cookieJar)&&o){let a=o.map(async h=>r.cookieJar.setCookie(h,n.toString()));r.ignoreInvalidCookies&&(a=a.map(async h=>{try{await h}catch{}}));try{await Promise.all(a)}catch(h){this._beforeError(h);return}}if(!this.isAborted){if(r.followRedirect&&e.headers.location&&od.has(s)){if(e.resume(),this._cancelTimeouts(),this._unproxyEvents(),this.redirectUrls.length>=r.maxRedirects){this._beforeError(new xt(this));return}this._request=void 0;let a=new J(void 0,void 0,this.options),h=s===303&&a.method!=="GET"&&a.method!=="HEAD",m=s!==307&&s!==308,b=a.methodRewriting&&m;(h||b)&&(a.method="GET",a.body=void 0,a.json=void 0,a.form=void 0,delete a.headers["content-length"]);try{let x=Kt.Buffer.from(e.headers.location,"binary").toString(),y=new URL(x,n);if(!Gt(n)&&Gt(y)){this._beforeError(new v("Cannot redirect to UNIX socket",{},this));return}y.hostname!==n.hostname||y.port!==n.port?("host"in a.headers&&delete a.headers.host,"cookie"in a.headers&&delete a.headers.cookie,"authorization"in a.headers&&delete a.headers.authorization,(a.username||a.password)&&(a.username="",a.password="")):(y.username=a.username,y.password=a.password),this.redirectUrls.push(y),a.prefixUrl="",a.url=y;for(let p of a.hooks.beforeRedirect)await p(a,i);this.emit("redirect",a,i),this.options=a,await this._makeRequest()}catch(x){this._beforeError(x);return}return}if(r.isStream&&r.throwHttpErrors&&!Ge(i)){this._beforeError(new Oe(i));return}if(e.on("readable",()=>{this._triggerRead&&this._read()}),this.on("resume",()=>{e.resume()}),this.on("pause",()=>{e.pause()}),e.once("end",()=>{this.push(null)}),this._noPipe){await this._setRawBody()&&this.emit("response",e);return}this.emit("response",e);for(let a of this._pipedServerResponses)if(!a.headersSent){for(let h in e.headers){let m=r.decompress?h!=="content-encoding":!0,b=e.headers[h];m&&a.setHeader(h,b)}a.statusCode=s}}}async _setRawBody(e=this){if(e.readableEnded)return!1;try{let r=await nd(e);if(!this.isAborted)return this.response.rawBody=r,!0}catch{}return!1}async _onResponse(e){try{await this._onResponseBase(e)}catch(r){this._beforeError(r)}}_onRequest(e){let{options:r}=this,{timeout:n,url:s}=r;Vn(e),this.options.http2&&e.setTimeout(0),this._cancelTimeouts=Tr(e,n,s);let i=r.cache?"cacheableResponse":"response";e.once(i,o=>{this._onResponse(o)}),e.once("error",o=>{this._aborted=!0,e.destroy(),o=o instanceof dt?new Ot(o,this.timings,this):new v(o.message,o,this),this._beforeError(o)}),this._unproxyEvents=ct(e,this,ad),this._request=e,this.emit("uploadProgress",this.uploadProgress),this._sendBody(),this.emit("request",e)}async _asyncWrite(e){return new Promise((r,n)=>{super.write(e,s=>{if(s){n(s);return}r()})})}_sendBody(){let{body:e}=this.options,r=this.redirectUrls.length===0?this:this._request??this;d.nodeStream(e)?e.pipe(r):d.generator(e)||d.asyncGenerator(e)?(async()=>{try{for await(let n of e)await this._asyncWrite(n);super.end()}catch(n){this._beforeError(n)}})():d.undefined(e)?(this._cannotHaveBody||this._noPipe)&&r.end():(this._writeRequest(e,void 0,()=>{}),r.end())}_prepareCache(e){if(!rn.has(e)){let r=new os((n,s)=>{let i=n._request(n,s);return d.promise(i)&&(i.once=(o,a)=>{if(o==="error")(async()=>{try{await i}catch(h){a(h)}})();else if(o==="abort")(async()=>{try{(await i).once("abort",a)}catch{}})();else throw new Error(`Unknown HTTP2 promise event: ${o}`);return i}),i},e);rn.set(e,r.request())}}async _createCacheableRequest(e,r){return new Promise((n,s)=>{Object.assign(r,Pr(e));let i,o=rn.get(r.cache)(r,async a=>{if(a._readableState.autoDestroy=!1,i){let h=()=>{a.req&&(a.complete=a.req.res.complete)};a.prependOnceListener("end",h),h(),(await i).emit("cacheableResponse",a)}n(a)});o.once("error",s),o.once("request",async a=>{i=a,n(i)})})}async _makeRequest(){let{options:e}=this,{headers:r,username:n,password:s}=e,i=e.cookieJar;for(let m in r)if(d.undefined(r[m]))delete r[m];else if(d.null_(r[m]))throw new TypeError(`Use \`undefined\` instead of \`null\` to delete the \`${m}\` header`);if(e.decompress&&d.undefined(r["accept-encoding"])&&(r["accept-encoding"]=sd?"gzip, deflate, br":"gzip, deflate"),n||s){let m=Kt.Buffer.from(`${n}:${s}`).toString("base64");r.authorization=`Basic ${m}`}if(i){let m=await i.getCookieString(e.url.toString());d.nonEmptyString(m)&&(r.cookie=m)}e.prefixUrl="";let o;for(let m of e.hooks.beforeRequest){let b=await m(e);if(!d.undefined(b)){o=()=>b;break}}o||(o=e.getRequestFunction());let a=e.url;this._requestOptions=e.createNativeRequestOptions(),e.cache&&(this._requestOptions._request=o,this._requestOptions.cache=e.cache,this._requestOptions.body=e.body,this._prepareCache(e.cache));let h=e.cache?this._createCacheableRequest:o;try{let m=h(a,this._requestOptions);d.promise(m)&&(m=await m),d.undefined(m)&&(m=e.getFallbackRequestFunction()(a,this._requestOptions),d.promise(m)&&(m=await m)),Hi(m)?this._onRequest(m):this.writable?(this.once("finish",()=>{this._onResponse(m)}),this._sendBody()):this._onResponse(m)}catch(m){throw m instanceof Se?new Ct(m,this):m}}async _error(e){try{if(!(e instanceof Oe&&!this.options.throwHttpErrors))for(let r of this.options.hooks.beforeError)e=await r(e)}catch(r){e=new v(r.message,r,this)}this.destroy(e)}_writeRequest(e,r,n){!this._request||this._request.destroyed||this._request.write(e,r,s=>{if(!s&&!this._request.destroyed){this._uploadedSize+=Kt.Buffer.byteLength(e,r);let i=this.uploadProgress;i.percent<1&&this.emit("uploadProgress",i)}n(s)})}get ip(){return this.socket?.remoteAddress}get isAborted(){return this._aborted}get socket(){return this._request?.socket??void 0}get downloadProgress(){let e;return this._responseSize?e=this._downloadedSize/this._responseSize:this._responseSize===this._downloadedSize?e=1:e=0,{percent:e,transferred:this._downloadedSize,total:this._responseSize}}get uploadProgress(){let e;return this._bodySize?e=this._uploadedSize/this._bodySize:this._bodySize===this._uploadedSize?e=1:e=0,{percent:e,transferred:this._uploadedSize,total:this._bodySize}}get timings(){return this._request?.timings}get isFromCache(){return this._isFromCache}get reusedSocket(){return this._request?.reusedSocket}};var ve=class extends v{constructor(e){super("Promise was canceled",{},e),this.name="CancelError",this.code="ERR_CANCELED"}get isCanceled(){return!0}};var cd=["request","response","redirect","uploadProgress","downloadProgress"];function Yt(t){let e,r,n,s=new $i.EventEmitter,i=new qe((a,h,m)=>{m(()=>{e.destroy()}),m.shouldReject=!1,m(()=>{h(new ve(e))});let b=x=>{m(()=>{});let y=t??new Ne(void 0,void 0,n);y.retryCount=x,y._noPipe=!0,e=y,y.once("response",async u=>{let S=(u.headers["content-encoding"]??"").toLowerCase(),_=S==="gzip"||S==="deflate"||S==="br",{options:R}=y;if(_&&!R.decompress)u.body=u.rawBody;else try{u.body=tn(u,R.responseType,R.parseJson,R.encoding)}catch(E){if(u.body=u.rawBody.toString(),Ge(u)){y._beforeError(E);return}}try{let E=R.hooks.afterResponse;for(let[P,U]of E.entries())if(u=await U(u,async N=>{throw R.merge(N),R.prefixUrl="",N.url&&(R.url=N.url),R.hooks.afterResponse=R.hooks.afterResponse.slice(0,P),new Rt(y)}),!(d.object(u)&&d.number(u.statusCode)&&!d.nullOrUndefined(u.body)))throw new TypeError("The `afterResponse` hook returned an invalid value")}catch(E){y._beforeError(E);return}if(r=u,!Ge(u)){y._beforeError(new Oe(u));return}y.destroy(),a(y.options.resolveBodyOnly?u.body:u)});let p=u=>{if(i.isCanceled)return;let{options:S}=y;if(u instanceof Oe&&!S.throwHttpErrors){let{response:_}=u;y.destroy(),a(y.options.resolveBodyOnly?_.body:_);return}h(u)};y.once("error",p);let l=y.options?.body;y.once("retry",(u,S)=>{t=void 0;let _=y.options.body;if(l===_&&d.nodeStream(_)){S.message="Cannot retry with consumed body stream",p(S);return}n=y.options,b(u)}),ct(y,s,cd),d.undefined(t)&&y.flush()};b(0)});i.on=(a,h)=>(s.on(a,h),i),i.off=(a,h)=>(s.off(a,h),i);let o=a=>{let h=(async()=>{await i;let{options:m}=r.request;return tn(r,a,m.parseJson,m.encoding)})();return Object.defineProperties(h,Object.getOwnPropertyDescriptors(i)),h};return i.json=()=>{if(e.options){let{headers:a}=e.options;!e.writableFinished&&!("accept"in a)&&(a.accept="application/json")}return o("json")},i.buffer=()=>o("buffer"),i.text=()=>o("text"),i}var dd=async t=>new Promise(e=>{setTimeout(e,t)}),hd=t=>d.function_(t),ud=["get","post","put","patch","head","delete"],zi=t=>{t={options:new J(void 0,void 0,t.options),handlers:[...t.handlers],mutableDefaults:t.mutableDefaults},Object.defineProperty(t,"mutableDefaults",{enumerable:!0,configurable:!1,writable:!1});let e=(n,s,i=t.options)=>{let o=new Ne(n,s,i),a,h=x=>(o.options=x,o._noPipe=!x.isStream,o.flush(),x.isStream?o:(a||(a=Yt(o)),a)),m=0,b=x=>{let p=(t.handlers[m++]??h)(x,b);if(d.promise(p)&&!o.options.isStream&&(a||(a=Yt(o)),p!==a)){let l=Object.getOwnPropertyDescriptors(a);for(let u in l)u in p&&delete l[u];Object.defineProperties(p,l),p.cancel=a.cancel}return p};return b(o.options)};e.extend=(...n)=>{let s=new J(void 0,void 0,t.options),i=[...t.handlers],o;for(let a of n)hd(a)?(s.merge(a.defaults.options),i.push(...a.defaults.handlers),o=a.defaults.mutableDefaults):(s.merge(a),a.handlers&&i.push(...a.handlers),o=a.mutableDefaults);return zi({options:s,handlers:i,mutableDefaults:!!o})};let r=async function*(n,s){let i=new J(n,s,t.options);i.resolveBodyOnly=!1;let{pagination:o}=i;g.function_(o.transform),g.function_(o.shouldContinue),g.function_(o.filter),g.function_(o.paginate),g.number(o.countLimit),g.number(o.requestLimit),g.number(o.backoff);let a=[],{countLimit:h}=o,m=0;for(;m<o.requestLimit;){m!==0&&await dd(o.backoff);let b=await e(void 0,void 0,i),x=await o.transform(b),y=[];g.array(x);for(let l of x)if(o.filter({item:l,currentItems:y,allItems:a})&&(!o.shouldContinue({item:l,currentItems:y,allItems:a})||(yield l,o.stackAllItems&&a.push(l),y.push(l),--h<=0)))return;let p=o.paginate({response:b,currentItems:y,allItems:a});if(p===!1)return;p===b.request.options?i=b.request.options:(i.merge(p),g.any([d.urlInstance,d.undefined],p.url),p.url!==void 0&&(i.prefixUrl="",i.url=p.url)),m++}};e.paginate=r,e.paginate.all=async(n,s)=>{let i=[];for await(let o of r(n,s))i.push(o);return i},e.paginate.each=r,e.stream=(n,s)=>e(n,{...s,isStream:!0});for(let n of ud)e[n]=(s,i)=>e(s,{...i,method:n}),e.stream[n]=(s,i)=>e(s,{...i,method:n,isStream:!0});return t.mutableDefaults||(Object.freeze(t.handlers),t.options.freeze()),Object.defineProperty(e,"defaults",{value:t,writable:!1,configurable:!1,enumerable:!0}),e},Mi=zi;var ld={options:new J,handlers:[],mutableDefaults:!1},md=Mi(ld),Fi=md;var Vi="[a-fA-F\\d:]",Pe=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${Vi})|(?<=${Vi})(?=\\s|$))`:"",ne="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",H="[a-fA-F\\d]{1,4}",Qt=`
(?:
(?:${H}:){7}(?:${H}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${H}:){6}(?:${ne}|:${H}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${H}:){5}(?::${ne}|(?::${H}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${H}:){4}(?:(?::${H}){0,1}:${ne}|(?::${H}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${H}:){3}(?:(?::${H}){0,2}:${ne}|(?::${H}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${H}:){2}(?:(?::${H}){0,3}:${ne}|(?::${H}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${H}:){1}(?:(?::${H}){0,4}:${ne}|(?::${H}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${H}){0,5}:${ne}|(?::${H}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),pd=new RegExp(`(?:^${ne}$)|(?:^${Qt}$)`),yd=new RegExp(`^${ne}$`),gd=new RegExp(`^${Qt}$`),sn=t=>t&&t.exact?pd:new RegExp(`(?:${Pe(t)}${ne}${Pe(t)})|(?:${Pe(t)}${Qt}${Pe(t)})`,"g");sn.v4=t=>t&&t.exact?yd:new RegExp(`${Pe(t)}${ne}${Pe(t)}`,"g");sn.v6=t=>t&&t.exact?gd:new RegExp(`${Pe(t)}${Qt}${Pe(t)}`,"g");var on=sn;var Gi=D(require("node:vm"),1);function an(t,{timeout:e}={}){let r=new Gi.default.Script("returnValue = function_()"),n=(...s)=>{let i={function_:()=>t(...s)};return r.runInNewContext(i,{timeout:e}),i.returnValue};return Object.defineProperty(n,"name",{value:`functionTimeout(${t.name||"<anonymous>"})`,configurable:!0}),n}function Wi(t){return t?.code==="ERR_SCRIPT_EXECUTION_TIMEOUT"}var{toString:fd}=Object.prototype;function cn(t){return fd.call(t)==="[object RegExp]"}var Ki={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function dn(t,e={}){if(!cn(t))throw new TypeError("Expected a RegExp instance");let r=Object.keys(Ki).map(s=>(typeof e[s]=="boolean"?e[s]:t[s])?Ki[s]:"").join(""),n=new RegExp(e.source||t.source,r);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:t.lastIndex,n}function hn(t,e,{timeout:r}={}){try{return an(()=>dn(t).test(e),{timeout:r})()}catch(n){if(Wi(n))return!1;throw n}}var _d=15,wd=45,Yi={timeout:400};function un(t){return t.length>wd?!1:hn(on.v6({exact:!0}),t,Yi)}function ln(t){return t.length>_d?!1:hn(on.v4({exact:!0}),t,Yi)}var We=class extends Error{constructor(e){super("Could not get the public IP address",e),this.name="IpNotFoundError"}};function Qi(t,e){return function(n){let s=t(n),i=e(n),o=(async()=>{try{let a=await i;return s.catch(()=>{}),s.cancel(),a}catch(a){if(!(a instanceof We))throw a;try{return await s}catch(h){throw new AggregateError([h,a])}}})();return o.cancel=()=>{s.cancel(),i.cancel()},o}}var to={timeout:5e3,onlyHttps:!1},Ji=[{v4:{servers:["208.67.222.222","208.67.220.220","208.67.222.220","208.67.220.222"],name:"myip.opendns.com",type:"A"},v6:{servers:["2620:0:ccc::2","2620:0:ccd::2"],name:"myip.opendns.com",type:"AAAA"}},{v4:{servers:["216.239.32.10","216.239.34.10","216.239.36.10","216.239.38.10"],name:"o-o.myaddr.l.google.com",type:"TXT",transform:t=>t.replaceAll('"',"")},v6:{servers:["2001:4860:4802:32::a","2001:4860:4802:34::a","2001:4860:4802:36::a","2001:4860:4802:38::a"],name:"o-o.myaddr.l.google.com",type:"TXT",transform:t=>t.replaceAll('"',"")}}],ro={v4:{dnsServers:Ji.map(({v4:{servers:t,...e}})=>({servers:t,question:e})),httpsUrls:["https://icanhazip.com/","https://api.ipify.org/"]},v6:{dnsServers:Ji.map(({v6:{servers:t,...e}})=>({servers:t,question:e})),httpsUrls:["https://icanhazip.com/","https://api6.ipify.org/"]}},mn=(t,e)=>{let r=ro[t],n=(0,eo.default)({retries:0,maxQueries:1,socket:Zi.default.createSocket(t==="v6"?"udp6":"udp4"),timeout:e.timeout}),s=(0,Xi.promisify)(n.query.bind(n)),i=(async()=>{let o;for(let a of r.dnsServers){let{servers:h,question:m}=a;for(let b of h){if(n.destroyed)return;try{let{name:x,type:y,transform:p}=m,l=await s({questions:[{name:x,type:y}]},53,b),{answers:{0:{data:u}}}=l,S=(typeof u=="string"?u:u.toString()).trim(),_=p?p(S):S;if(_&&(t==="v6"?un:ln)(_))return n.destroy(),_}catch(x){o=x}}}throw n.destroy(),new We({cause:o})})();return i.cancel=()=>{n.destroy()},i},pn=(t,e)=>{let r,n=(async()=>{try{let s={dnsLookupIpVersion:t==="v6"?6:4,retry:{limit:0},timeout:{request:e.timeout}},i=[...ro[t].httpsUrls,...e.fallbackUrls??[]],o;for(let a of i)try{let h=Fi.get(a,s);r=h.cancel;let b=(await h).body?.trim();if(b&&(t==="v6"?un:ln)(b))return b}catch(h){if(o=h,h instanceof ve)throw h}throw new We({cause:o})}catch(s){if(!(s instanceof ve))throw s}})();return n.cancel=function(){return r.apply(this)},n},no=(t,e)=>{let r,n=(async()=>{let s,i=mn(t,e);r=i.cancel;try{s=await i}catch{let o=pn(t,e);r=o.cancel,s=await o}return s})();return n.cancel=r,n},Dl=Qi(yn,gn);function yn(t){return t={...to,...t},t.onlyHttps?t.onlyHttps?pn("v4",t):mn("v4",t):no("v4",t)}function gn(t){return t={...to,...t},t.onlyHttps?t.onlyHttps?pn("v6",t):mn("v6",t):no("v6",t)}var bd=async t=>{let{args:e}=xn([t.arguments.ipType,t.arguments.ipVersion],["ipType","IpVersion"]),r=e[0]==="Public"?"Public":"Local",n=e[1]==="IPv6"?"IPv6":"IPv4";try{j.environment.launchType===j.LaunchType.UserInitiated&&await(0,j.closeMainWindow)();let s="";if(r==="Local"){let i;n==="IPv4"?i=En():i=Sn(),s=i||""}else{let i;n==="IPv4"?i=await yn({onlyHttps:!0}).then(o=>o).catch(()=>""):i=await gn({onlyHttps:!0}).then(o=>o).catch(()=>""),s=i||""}j.environment.launchType===j.LaunchType.UserInitiated&&(bn(s)?await(0,j.showHUD)(`\u{1F6A8} Failed to get ${r} ${n} `):(await j.Clipboard.copy(`${s}`),await(0,j.showHUD)(`\u{1F17F}\uFE0F ${r} ${n} ${s}`))),s?await(0,j.updateCommandMetadata)({subtitle:` ${r} ${n} ${s}`}):await(0,j.updateCommandMetadata)({subtitle:"IP Geolocation"})}catch(s){(0,j.captureException)(s),console.error(s)}};
